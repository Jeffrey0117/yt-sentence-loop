"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/transcript/route";
exports.ids = ["app/api/transcript/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("child_process");

/***/ }),

/***/ "fs/promises":
/*!******************************!*\
  !*** external "fs/promises" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("fs/promises");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/next@14.2.3_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftranscript%2Froute&page=%2Fapi%2Ftranscript%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftranscript%2Froute.ts&appDir=C%3A%5CUsers%5CJeffrey%5CDesktop%5Ccode%5Cyt-sentence-loop%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CJeffrey%5CDesktop%5Ccode%5Cyt-sentence-loop&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@14.2.3_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftranscript%2Froute&page=%2Fapi%2Ftranscript%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftranscript%2Froute.ts&appDir=C%3A%5CUsers%5CJeffrey%5CDesktop%5Ccode%5Cyt-sentence-loop%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CJeffrey%5CDesktop%5Ccode%5Cyt-sentence-loop&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/.pnpm/next@14.2.3_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/.pnpm/next@14.2.3_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/.pnpm/next@14.2.3_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_Jeffrey_Desktop_code_yt_sentence_loop_app_api_transcript_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/transcript/route.ts */ \"(rsc)/./app/api/transcript/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/transcript/route\",\n        pathname: \"/api/transcript\",\n        filename: \"route\",\n        bundlePath: \"app/api/transcript/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\Jeffrey\\\\Desktop\\\\code\\\\yt-sentence-loop\\\\app\\\\api\\\\transcript\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_Jeffrey_Desktop_code_yt_sentence_loop_app_api_transcript_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/transcript/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbmV4dEAxNC4yLjNfcmVhY3QtZG9tQDE4LjIuMF9yZWFjdEAxOC4yLjBfX3JlYWN0QDE4LjIuMC9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZ0cmFuc2NyaXB0JTJGcm91dGUmcGFnZT0lMkZhcGklMkZ0cmFuc2NyaXB0JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGdHJhbnNjcmlwdCUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNKZWZmcmV5JTVDRGVza3RvcCU1Q2NvZGUlNUN5dC1zZW50ZW5jZS1sb29wJTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1DJTNBJTVDVXNlcnMlNUNKZWZmcmV5JTVDRGVza3RvcCU1Q2NvZGUlNUN5dC1zZW50ZW5jZS1sb29wJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNtQztBQUNoSDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3l0LXNlbnRlbmNlLWxvb3AvPzllZWIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxcVXNlcnNcXFxcSmVmZnJleVxcXFxEZXNrdG9wXFxcXGNvZGVcXFxceXQtc2VudGVuY2UtbG9vcFxcXFxhcHBcXFxcYXBpXFxcXHRyYW5zY3JpcHRcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3RyYW5zY3JpcHQvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS90cmFuc2NyaXB0XCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS90cmFuc2NyaXB0L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiQzpcXFxcVXNlcnNcXFxcSmVmZnJleVxcXFxEZXNrdG9wXFxcXGNvZGVcXFxceXQtc2VudGVuY2UtbG9vcFxcXFxhcHBcXFxcYXBpXFxcXHRyYW5zY3JpcHRcXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL3RyYW5zY3JpcHQvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/next@14.2.3_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftranscript%2Froute&page=%2Fapi%2Ftranscript%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftranscript%2Froute.ts&appDir=C%3A%5CUsers%5CJeffrey%5CDesktop%5Ccode%5Cyt-sentence-loop%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CJeffrey%5CDesktop%5Ccode%5Cyt-sentence-loop&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/transcript/route.ts":
/*!*************************************!*\
  !*** ./app/api/transcript/route.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   dynamic: () => (/* binding */ dynamic)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/.pnpm/next@14.2.3_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_transcript__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/transcript */ \"(rsc)/./lib/transcript.ts\");\n/* harmony import */ var _lib_transcriptCache__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/transcriptCache */ \"(rsc)/./lib/transcriptCache.ts\");\n/* harmony import */ var _lib_vtt__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/vtt */ \"(rsc)/./lib/vtt.ts\");\n\n\n\n\n// Helper function to convert cues to VTT format\nfunction cuesToVTT(cues) {\n    let vtt = \"WEBVTT\\n\\n\";\n    cues.forEach((cue, index)=>{\n        vtt += `${index + 1}\\n`;\n        vtt += `${formatTime(cue.start)} --> ${formatTime(cue.end)}\\n`;\n        vtt += `${cue.text}\\n\\n`;\n    });\n    return vtt;\n}\n// Helper function to format time in VTT format (HH:MM:SS.mmm)\nfunction formatTime(seconds) {\n    const date = new Date(0);\n    date.setSeconds(seconds);\n    return date.toISOString().substr(11, 12).replace(\".\", \",\");\n}\nconst dynamic = \"force-dynamic\";\nasync function GET(req) {\n    const videoId = req.nextUrl.searchParams.get(\"videoId\");\n    const lang = req.nextUrl.searchParams.get(\"lang\") || \"zh-TW,zh,en\";\n    // 預設強制刷新快取\n    const forceRefresh = req.nextUrl.searchParams.get(\"forceRefresh\") !== \"false\";\n    if (!videoId) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"missing videoId\"\n        }, {\n            status: 400\n        });\n    }\n    try {\n        // 強制刷新或使用快取\n        if (!forceRefresh) {\n            try {\n                // 先嘗試從快取讀取\n                const cached = await (0,_lib_transcriptCache__WEBPACK_IMPORTED_MODULE_2__.getOrCreateTranscript)(videoId, \"\");\n                if (cached) {\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        ...cached,\n                        source: \"cache\",\n                        timestamp: new Date().toISOString()\n                    });\n                }\n            } catch (error) {\n                console.warn(\"Cache read failed, falling back to fresh fetch:\", error);\n            }\n        }\n        // 從 YouTube 獲取新的字幕\n        console.log(`Fetching subtitles for video: ${videoId}`);\n        try {\n            const vttContent = await (0,_lib_transcript__WEBPACK_IMPORTED_MODULE_1__.getTranscriptByYtDlp)(videoId, String(lang));\n            if (!vttContent) {\n                console.error(\"No subtitle content returned from getTranscriptByYtDlp\");\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"No subtitles available\",\n                    message: \"This video may not have subtitles or they may be disabled.\"\n                }, {\n                    status: 404\n                });\n            }\n            console.log(\"Successfully fetched VTT content, length:\", vttContent.length);\n            // 解析 VTT 內容\n            console.log(\"Parsing VTT content...\");\n            const cues = (0,_lib_vtt__WEBPACK_IMPORTED_MODULE_3__.parseVTT)(vttContent);\n            if (!cues || cues.length === 0) {\n                console.error(\"No cues found in VTT content\");\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"No subtitles found\",\n                    message: \"The video appears to have subtitles but they could not be parsed.\"\n                }, {\n                    status: 400\n                });\n            }\n            console.log(`Successfully parsed ${cues.length} cues`);\n            // 處理並快取字幕\n            console.log(\"Caching transcript...\");\n            const result = await (0,_lib_transcriptCache__WEBPACK_IMPORTED_MODULE_2__.getOrCreateTranscript)(videoId, vttContent);\n            console.log(\"Transcript cached successfully\");\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                ...result,\n                source: \"yt-dlp\",\n                timestamp: new Date().toISOString()\n            });\n        } catch (error) {\n            console.error(\"Error processing transcript:\", error);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Failed to process transcript\",\n                details: error instanceof Error ? error.message : \"Unknown error occurred\"\n            }, {\n                status: 500\n            });\n        }\n    } catch (e) {\n        console.error(\"Transcript error:\", e);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: e?.message || \"Failed to process transcript\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VUFBVTtZQUNWTixRQUFRRSxHQUFHLENBQUM7WUFDWixNQUFNSyxTQUFTLE1BQU16QywyRUFBcUJBLENBQUNzQixTQUFTZTtZQUNwREgsUUFBUUUsR0FBRyxDQUFDO1lBRVosT0FBT3RDLHFEQUFZQSxDQUFDOEIsSUFBSSxDQUFDO2dCQUN2QixHQUFHYSxNQUFNO2dCQUNUVCxRQUFRO2dCQUNSQyxXQUFXLElBQUluQixPQUFPRSxXQUFXO1lBQ25DO1FBRUYsRUFBRSxPQUFPYSxPQUFPO1lBQ2RLLFFBQVFMLEtBQUssQ0FBQyxnQ0FBZ0NBO1lBQzlDLE9BQU8vQixxREFBWUEsQ0FBQzhCLElBQUksQ0FDdEI7Z0JBQ0VDLE9BQU87Z0JBQ1BhLFNBQVNiLGlCQUFpQmMsUUFBUWQsTUFBTVUsT0FBTyxHQUFHO1lBQ3BELEdBQ0E7Z0JBQUVULFFBQVE7WUFBSTtRQUVsQjtJQUVGLEVBQUUsT0FBT2MsR0FBUTtRQUNmVixRQUFRTCxLQUFLLENBQUMscUJBQXFCZTtRQUNuQyxPQUFPOUMscURBQVlBLENBQUM4QixJQUFJLENBQ3RCO1lBQUVDLE9BQU9lLEdBQUdMLFdBQVc7UUFBK0IsR0FDdEQ7WUFBRVQsUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly95dC1zZW50ZW5jZS1sb29wLy4vYXBwL2FwaS90cmFuc2NyaXB0L3JvdXRlLnRzPzgyNDUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCB7IGdldFRyYW5zY3JpcHRCeVl0RGxwIH0gZnJvbSAnQC9saWIvdHJhbnNjcmlwdCc7XG5pbXBvcnQgeyBnZXRPckNyZWF0ZVRyYW5zY3JpcHQgfSBmcm9tICdAL2xpYi90cmFuc2NyaXB0Q2FjaGUnO1xuaW1wb3J0IHsgcGFyc2VWVFQgfSBmcm9tICdAL2xpYi92dHQnO1xuXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gY29udmVydCBjdWVzIHRvIFZUVCBmb3JtYXRcbmZ1bmN0aW9uIGN1ZXNUb1ZUVChjdWVzOiBBcnJheTx7IHN0YXJ0OiBudW1iZXI7IGVuZDogbnVtYmVyOyB0ZXh0OiBzdHJpbmcgfT4pOiBzdHJpbmcge1xuICBsZXQgdnR0ID0gJ1dFQlZUVFxcblxcbic7XG4gIFxuICBjdWVzLmZvckVhY2goKGN1ZSwgaW5kZXgpID0+IHtcbiAgICB2dHQgKz0gYCR7aW5kZXggKyAxfVxcbmA7XG4gICAgdnR0ICs9IGAke2Zvcm1hdFRpbWUoY3VlLnN0YXJ0KX0gLS0+ICR7Zm9ybWF0VGltZShjdWUuZW5kKX1cXG5gO1xuICAgIHZ0dCArPSBgJHtjdWUudGV4dH1cXG5cXG5gO1xuICB9KTtcbiAgXG4gIHJldHVybiB2dHQ7XG59XG5cbi8vIEhlbHBlciBmdW5jdGlvbiB0byBmb3JtYXQgdGltZSBpbiBWVFQgZm9ybWF0IChISDpNTTpTUy5tbW0pXG5mdW5jdGlvbiBmb3JtYXRUaW1lKHNlY29uZHM6IG51bWJlcik6IHN0cmluZyB7XG4gIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSgwKTtcbiAgZGF0ZS5zZXRTZWNvbmRzKHNlY29uZHMpO1xuICByZXR1cm4gZGF0ZS50b0lTT1N0cmluZygpLnN1YnN0cigxMSwgMTIpLnJlcGxhY2UoJy4nLCAnLCcpO1xufVxuXG5leHBvcnQgY29uc3QgZHluYW1pYyA9ICdmb3JjZS1keW5hbWljJztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXE6IE5leHRSZXF1ZXN0KSB7XG4gIGNvbnN0IHZpZGVvSWQgPSByZXEubmV4dFVybC5zZWFyY2hQYXJhbXMuZ2V0KCd2aWRlb0lkJyk7XG4gIGNvbnN0IGxhbmcgPSByZXEubmV4dFVybC5zZWFyY2hQYXJhbXMuZ2V0KCdsYW5nJykgfHwgJ3poLVRXLHpoLGVuJztcbiAgLy8g6aCQ6Kit5by35Yi25Yi35paw5b+r5Y+WXG4gIGNvbnN0IGZvcmNlUmVmcmVzaCA9IHJlcS5uZXh0VXJsLnNlYXJjaFBhcmFtcy5nZXQoJ2ZvcmNlUmVmcmVzaCcpICE9PSAnZmFsc2UnO1xuXG4gIGlmICghdmlkZW9JZCkge1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnbWlzc2luZyB2aWRlb0lkJyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICB9XG5cbiAgdHJ5IHtcbiAgICAvLyDlvLfliLbliLfmlrDmiJbkvb/nlKjlv6vlj5ZcbiAgICBpZiAoIWZvcmNlUmVmcmVzaCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgLy8g5YWI5ZiX6Kmm5b6e5b+r5Y+W6K6A5Y+WXG4gICAgICAgIGNvbnN0IGNhY2hlZCA9IGF3YWl0IGdldE9yQ3JlYXRlVHJhbnNjcmlwdCh2aWRlb0lkLCAnJyk7XG4gICAgICAgIGlmIChjYWNoZWQpIHtcbiAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICAgICAgLi4uY2FjaGVkLFxuICAgICAgICAgICAgc291cmNlOiAnY2FjaGUnLFxuICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdDYWNoZSByZWFkIGZhaWxlZCwgZmFsbGluZyBiYWNrIHRvIGZyZXNoIGZldGNoOicsIGVycm9yKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyDlvp4gWW91VHViZSDnjbLlj5bmlrDnmoTlrZfluZVcbiAgICBjb25zb2xlLmxvZyhgRmV0Y2hpbmcgc3VidGl0bGVzIGZvciB2aWRlbzogJHt2aWRlb0lkfWApO1xuICAgIFxuICAgIHRyeSB7XG4gICAgICBjb25zdCB2dHRDb250ZW50ID0gYXdhaXQgZ2V0VHJhbnNjcmlwdEJ5WXREbHAodmlkZW9JZCwgU3RyaW5nKGxhbmcpKTtcbiAgICAgIFxuICAgICAgaWYgKCF2dHRDb250ZW50KSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ05vIHN1YnRpdGxlIGNvbnRlbnQgcmV0dXJuZWQgZnJvbSBnZXRUcmFuc2NyaXB0QnlZdERscCcpO1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBcbiAgICAgICAgICBlcnJvcjogJ05vIHN1YnRpdGxlcyBhdmFpbGFibGUnLFxuICAgICAgICAgIG1lc3NhZ2U6ICdUaGlzIHZpZGVvIG1heSBub3QgaGF2ZSBzdWJ0aXRsZXMgb3IgdGhleSBtYXkgYmUgZGlzYWJsZWQuJ1xuICAgICAgICB9LCB7IHN0YXR1czogNDA0IH0pO1xuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygnU3VjY2Vzc2Z1bGx5IGZldGNoZWQgVlRUIGNvbnRlbnQsIGxlbmd0aDonLCB2dHRDb250ZW50Lmxlbmd0aCk7XG4gICAgICBcbiAgICAgIC8vIOino+aekCBWVFQg5YWn5a65XG4gICAgICBjb25zb2xlLmxvZygnUGFyc2luZyBWVFQgY29udGVudC4uLicpO1xuICAgICAgY29uc3QgY3VlcyA9IHBhcnNlVlRUKHZ0dENvbnRlbnQpO1xuICAgICAgXG4gICAgICBpZiAoIWN1ZXMgfHwgY3Vlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignTm8gY3VlcyBmb3VuZCBpbiBWVFQgY29udGVudCcpO1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBcbiAgICAgICAgICBlcnJvcjogJ05vIHN1YnRpdGxlcyBmb3VuZCcsXG4gICAgICAgICAgbWVzc2FnZTogJ1RoZSB2aWRlbyBhcHBlYXJzIHRvIGhhdmUgc3VidGl0bGVzIGJ1dCB0aGV5IGNvdWxkIG5vdCBiZSBwYXJzZWQuJ1xuICAgICAgICB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zb2xlLmxvZyhgU3VjY2Vzc2Z1bGx5IHBhcnNlZCAke2N1ZXMubGVuZ3RofSBjdWVzYCk7XG4gICAgICBcbiAgICAgIC8vIOiZleeQhuS4puW/q+WPluWtl+W5lVxuICAgICAgY29uc29sZS5sb2coJ0NhY2hpbmcgdHJhbnNjcmlwdC4uLicpO1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0T3JDcmVhdGVUcmFuc2NyaXB0KHZpZGVvSWQsIHZ0dENvbnRlbnQpO1xuICAgICAgY29uc29sZS5sb2coJ1RyYW5zY3JpcHQgY2FjaGVkIHN1Y2Nlc3NmdWxseScpO1xuICAgICAgXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICAuLi5yZXN1bHQsXG4gICAgICAgIHNvdXJjZTogJ3l0LWRscCcsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICB9KTtcbiAgICAgIFxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBwcm9jZXNzaW5nIHRyYW5zY3JpcHQ6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IFxuICAgICAgICAgIGVycm9yOiAnRmFpbGVkIHRvIHByb2Nlc3MgdHJhbnNjcmlwdCcsXG4gICAgICAgICAgZGV0YWlsczogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvciBvY2N1cnJlZCdcbiAgICAgICAgfSxcbiAgICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgICApO1xuICAgIH1cblxuICB9IGNhdGNoIChlOiBhbnkpIHtcbiAgICBjb25zb2xlLmVycm9yKCdUcmFuc2NyaXB0IGVycm9yOicsIGUpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6IGU/Lm1lc3NhZ2UgfHwgJ0ZhaWxlZCB0byBwcm9jZXNzIHRyYW5zY3JpcHQnIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiZ2V0VHJhbnNjcmlwdEJ5WXREbHAiLCJnZXRPckNyZWF0ZVRyYW5zY3JpcHQiLCJwYXJzZVZUVCIsImN1ZXNUb1ZUVCIsImN1ZXMiLCJ2dHQiLCJmb3JFYWNoIiwiY3VlIiwiaW5kZXgiLCJmb3JtYXRUaW1lIiwic3RhcnQiLCJlbmQiLCJ0ZXh0Iiwic2Vjb25kcyIsImRhdGUiLCJEYXRlIiwic2V0U2Vjb25kcyIsInRvSVNPU3RyaW5nIiwic3Vic3RyIiwicmVwbGFjZSIsImR5bmFtaWMiLCJHRVQiLCJyZXEiLCJ2aWRlb0lkIiwibmV4dFVybCIsInNlYXJjaFBhcmFtcyIsImdldCIsImxhbmciLCJmb3JjZVJlZnJlc2giLCJqc29uIiwiZXJyb3IiLCJzdGF0dXMiLCJjYWNoZWQiLCJzb3VyY2UiLCJ0aW1lc3RhbXAiLCJjb25zb2xlIiwid2FybiIsImxvZyIsInZ0dENvbnRlbnQiLCJTdHJpbmciLCJtZXNzYWdlIiwibGVuZ3RoIiwicmVzdWx0IiwiZGV0YWlscyIsIkVycm9yIiwiZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/transcript/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/transcript.ts":
/*!***************************!*\
  !*** ./lib/transcript.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getTranscriptByYtDlp: () => (/* binding */ getTranscriptByYtDlp)\n/* harmony export */ });\n/* harmony import */ var child_process__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! child_process */ \"child_process\");\n/* harmony import */ var child_process__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(child_process__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fs/promises */ \"fs/promises\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(fs_promises__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var os__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! os */ \"os\");\n/* harmony import */ var os__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(os__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _vtt__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./vtt */ \"(rsc)/./lib/vtt.ts\");\n\n\n\n\n\nasync function getTranscriptByYtDlp(videoId, lang = \"en,*\") {\n    const workdir = await fs_promises__WEBPACK_IMPORTED_MODULE_1___default().mkdtemp(path__WEBPACK_IMPORTED_MODULE_2___default().join(os__WEBPACK_IMPORTED_MODULE_3___default().tmpdir(), \"yt-vtt-\"));\n    const url = `https://www.youtube.com/watch?v=${videoId}`;\n    try {\n        // 優先作者字幕，否則自動字幕；輸出成    // 首先檢查是否有可用的字幕\n        const listArgs = [\n            \"--list-subs\",\n            \"--skip-download\",\n            url\n        ];\n        console.log(\"Checking available subtitles...\");\n        const listProcess = (0,child_process__WEBPACK_IMPORTED_MODULE_0__.spawn)(\"yt-dlp\", listArgs, {\n            stdio: [\n                \"ignore\",\n                \"pipe\",\n                \"pipe\"\n            ]\n        });\n        let hasSubtitles = false;\n        let output = \"\";\n        for await (const data of listProcess.stdout){\n            const text = data.toString();\n            output += text;\n            // 檢查是否有可用的字幕（包括自動字幕和人工字幕）\n            if (text.includes(\"Available subtitles for\") || text.includes(\"Available automatic captions\") || text.match(/\\w+\\s+\\w+\\s+[\\w-]+/)) {\n                hasSubtitles = true;\n            }\n        }\n        // 等待進程完成\n        await new Promise((resolve, reject)=>{\n            listProcess.on(\"close\", (code)=>{\n                if (code === 0) resolve(code);\n                else reject(new Error(`yt-dlp list-subs failed with code ${code}`));\n            });\n        });\n        if (!hasSubtitles) {\n            console.log(\"No subtitles available for this video. Output:\", output);\n            throw new Error(\"No subtitles available for this video. The video may not have subtitles enabled.\");\n        }\n        console.log(\"Subtitles available, proceeding with download...\");\n        // 下載字幕的參數，添加速率限制和重試機制\n        const args = [\n            url,\n            \"--skip-download\",\n            \"--sub-lang\",\n            \"en,zh-TW,zh-Hant,zh,en-US,en-UK,en-GB,en-CA,en-AU,en-NZ,en-IE,en-ZA,en-JM,en-BZ,en-TT,zh-Hans,zh-CN,zh-SG,zh-HK,zh-MO,zh-TW\",\n            \"--write-sub\",\n            \"--write-auto-sub\",\n            \"--sub-format\",\n            \"vtt\",\n            \"--convert-subs\",\n            \"vtt\",\n            \"-o\",\n            path__WEBPACK_IMPORTED_MODULE_2___default().join(workdir, \"%(id)s.%(ext)s\"),\n            \"--no-warnings\",\n            \"--no-check-certificate\",\n            \"--ignore-errors\",\n            \"--no-call-home\",\n            \"--no-progress\",\n            \"--sleep-interval\",\n            \"1\",\n            \"--max-sleep-interval\",\n            \"5\",\n            \"--retries\",\n            \"3\",\n            \"--extractor-retries\",\n            \"3\",\n            \"--user-agent\",\n            \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36\"\n        ];\n        console.log(\"Running yt-dlp with args:\", args.join(\" \"));\n        console.log(`Downloading subtitles for video: ${videoId}`);\n        await run(\"yt-dlp\", args);\n        // 找出所有可能的字幕文件\n        const files = await fs_promises__WEBPACK_IMPORTED_MODULE_1___default().readdir(workdir);\n        console.log(\"All files in temp directory:\", files);\n        // 嘗試查找任何字幕文件\n        const subtitleExtensions = [\n            \".vtt\",\n            \".srt\",\n            \".ass\",\n            \".ssa\",\n            \".vtt.yt-dlp\",\n            \".srt.yt-dlp\"\n        ];\n        const subtitleFiles = files.filter((f)=>subtitleExtensions.some((ext)=>f.endsWith(ext)));\n        if (subtitleFiles.length === 0) {\n            console.error(\"No subtitle files found in:\", workdir);\n            console.log(\"Available files:\", files);\n            // 嘗試獲取視頻信息以提供更好的錯誤信息\n            const infoArgs = [\n                \"--skip-download\",\n                \"--dump-json\",\n                \"--no-warnings\",\n                url\n            ];\n            try {\n                const infoOutput = await new Promise((resolve, reject)=>{\n                    const infoProcess = (0,child_process__WEBPACK_IMPORTED_MODULE_0__.spawn)(\"yt-dlp\", infoArgs, {\n                        stdio: [\n                            \"ignore\",\n                            \"pipe\",\n                            \"pipe\"\n                        ]\n                    });\n                    let output = \"\";\n                    infoProcess.stdout.on(\"data\", (data)=>output += data.toString());\n                    infoProcess.stderr.on(\"data\", (data)=>console.error(\"yt-dlp stderr:\", data.toString()));\n                    infoProcess.on(\"close\", (code)=>{\n                        if (code === 0) resolve(output);\n                        else reject(new Error(`yt-dlp info failed with code ${code}`));\n                    });\n                });\n                const videoInfo = JSON.parse(infoOutput);\n                console.log(\"Video info:\", {\n                    title: videoInfo.title,\n                    duration: videoInfo.duration,\n                    uploader: videoInfo.uploader,\n                    is_live: videoInfo.is_live\n                });\n                // 檢查是否是直播或即將直播的視頻\n                if (videoInfo.is_live || videoInfo.live_status === \"is_upcoming\") {\n                    throw new Error(\"This is a live or upcoming stream. Subtitles are typically not available for live content.\");\n                }\n                // 檢查視頻時長\n                if (videoInfo.duration < 30) {\n                    throw new Error(\"This video is very short. Subtitles may not be available for very short videos.\");\n                }\n                // 檢查視頻是否被下架或私密\n                if (videoInfo.availability === \"private\" || videoInfo.availability === \"unlisted\") {\n                    throw new Error(\"This video is private or unlisted. Subtitles may not be available.\");\n                }\n            } catch (error) {\n                console.error(\"Error getting video info:\", error);\n            // 繼續使用通用錯誤信息\n            }\n            throw new Error(`No subtitles available for this video. The video may not have subtitles enabled or they may be restricted.`);\n        }\n        console.log(\"Found subtitle files:\", subtitleFiles);\n        const vtts = subtitleFiles; // 使用找到的所有字幕文件\n        // 按語言優先級排序\n        vtts.sort((a, b)=>{\n            const langOrder = [\n                \"zh-TW\",\n                \"zh-Hant\",\n                \"zh\",\n                \"en\",\n                \"a.*\"\n            ];\n            const aLang = a.split(\".\")[1] || \"\";\n            const bLang = b.split(\".\")[1] || \"\";\n            return langOrder.indexOf(aLang) - langOrder.indexOf(bLang);\n        });\n        // 讀取第一個可用的 VTT 文件\n        const file = path__WEBPACK_IMPORTED_MODULE_2___default().join(workdir, vtts[0]);\n        console.log(`Using subtitle file: ${file}`);\n        const text = await fs_promises__WEBPACK_IMPORTED_MODULE_1___default().readFile(file, \"utf8\");\n        // 清理 VTT 內容\n        const cleanedText = text.replace(/^WEBVTT.*\\n\\n/, \"\") // 移除 WEBVTT 標頭\n        .replace(/\\r\\n/g, \"\\n\") // 統一換行符\n        .replace(/\\r/g, \"\\n\").replace(/^\\s+/, \"\") // 移除開頭空白\n        .replace(/\\s+$/, \"\"); // 移除結尾空白\n        console.log(\"VTT content length:\", cleanedText.length);\n        // 解析 VTT 內容\n        const cues = (0,_vtt__WEBPACK_IMPORTED_MODULE_4__.parseVTT)(cleanedText);\n        if (cues.length === 0) {\n            console.warn(\"No cues found in VTT content\");\n        } else {\n            console.log(`Parsed ${cues.length} cues from VTT`);\n        }\n        return cleanedText; // 返回原始 VTT 內容，由 parseVTT 處理\n    } catch (error) {\n        console.error(\"Error in getTranscriptByYtDlp:\", error);\n        throw error;\n    } finally{\n        // 清理暫存目錄\n        try {\n            await fs_promises__WEBPACK_IMPORTED_MODULE_1___default().rm(workdir, {\n                recursive: true,\n                force: true\n            });\n        } catch (error) {\n            console.warn(\"Failed to clean up temp directory:\", error);\n        }\n    }\n}\nasync function run(cmd, args) {\n    return new Promise((resolve, reject)=>{\n        const p = (0,child_process__WEBPACK_IMPORTED_MODULE_0__.spawn)(cmd, args, {\n            stdio: [\n                \"ignore\",\n                \"pipe\",\n                \"pipe\"\n            ]\n        });\n        let stdout = \"\";\n        let stderr = \"\";\n        p.stdout?.on(\"data\", (data)=>{\n            const text = data.toString();\n            stdout += text;\n            console.log(text);\n        });\n        p.stderr?.on(\"data\", (data)=>{\n            const text = data.toString();\n            stderr += text;\n            console.error(text);\n        });\n        p.on(\"error\", reject);\n        p.on(\"exit\", (code)=>{\n            if (code === 0) {\n                resolve();\n            } else {\n                reject(new Error(`${cmd} exit ${code}. stderr: ${stderr}`));\n            }\n        });\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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OUIsUUFBUThCLEtBQUssQ0FBQyxrQ0FBa0NBO1FBQ2hELE1BQU1BO0lBRVIsU0FBVTtRQUNSLFNBQVM7UUFDVCxJQUFJO1lBQ0YsTUFBTTNDLHFEQUFLLENBQUNPLFNBQVM7Z0JBQUVrRSxXQUFXO2dCQUFNQyxPQUFPO1lBQUs7UUFDdEQsRUFBRSxPQUFPL0IsT0FBTztZQUNkOUIsUUFBUTBELElBQUksQ0FBQyxzQ0FBc0M1QjtRQUNyRDtJQUNGO0FBQ0Y7QUFDQSxlQUFlWCxJQUFJMkMsR0FBVyxFQUFFNUMsSUFBYztJQUM1QyxPQUFPLElBQUlOLFFBQWMsQ0FBQ0MsU0FBU0M7UUFDakMsTUFBTWlELElBQUk3RSxvREFBS0EsQ0FBQzRFLEtBQUs1QyxNQUFNO1lBQUVmLE9BQU87Z0JBQUM7Z0JBQVU7Z0JBQVE7YUFBTztRQUFDO1FBRS9ELElBQUlJLFNBQVM7UUFDYixJQUFJMkIsU0FBUztRQUViNkIsRUFBRXhELE1BQU0sRUFBRVEsR0FBRyxRQUFRLENBQUNUO1lBQ3BCLE1BQU1FLE9BQU9GLEtBQUtHLFFBQVE7WUFDMUJGLFVBQVVDO1lBQ1ZSLFFBQVFDLEdBQUcsQ0FBQ087UUFDZDtRQUVBdUQsRUFBRTdCLE1BQU0sRUFBRW5CLEdBQUcsUUFBUSxDQUFDVDtZQUNwQixNQUFNRSxPQUFPRixLQUFLRyxRQUFRO1lBQzFCeUIsVUFBVTFCO1lBQ1ZSLFFBQVE4QixLQUFLLENBQUN0QjtRQUNoQjtRQUVBdUQsRUFBRWhELEVBQUUsQ0FBQyxTQUFTRDtRQUNkaUQsRUFBRWhELEVBQUUsQ0FBQyxRQUFRLENBQUNDO1lBQ1osSUFBSUEsU0FBUyxHQUFHO2dCQUNkSDtZQUNGLE9BQU87Z0JBQ0xDLE9BQU8sSUFBSUcsTUFBTSxDQUFDLEVBQUU2QyxJQUFJLE1BQU0sRUFBRTlDLEtBQUssVUFBVSxFQUFFa0IsT0FBTyxDQUFDO1lBQzNEO1FBQ0Y7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8veXQtc2VudGVuY2UtbG9vcC8uL2xpYi90cmFuc2NyaXB0LnRzP2M1NmYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc3Bhd24gfSBmcm9tICdjaGlsZF9wcm9jZXNzJztcbmltcG9ydCBmcyBmcm9tICdmcy9wcm9taXNlcyc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCBvcyBmcm9tICdvcyc7XG5pbXBvcnQgeyBwYXJzZVZUVCB9IGZyb20gJy4vdnR0JztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFRyYW5zY3JpcHRCeVl0RGxwKHZpZGVvSWQ6IHN0cmluZywgbGFuZyA9ICdlbiwqJykge1xuICBjb25zdCB3b3JrZGlyID0gYXdhaXQgZnMubWtkdGVtcChwYXRoLmpvaW4ob3MudG1wZGlyKCksICd5dC12dHQtJykpO1xuICBjb25zdCB1cmwgPSBgaHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj0ke3ZpZGVvSWR9YDtcblxuICB0cnkge1xuICAgIC8vIOWEquWFiOS9nOiAheWtl+W5le+8jOWQpuWJh+iHquWLleWtl+W5le+8m+i8uOWHuuaIkCAgICAvLyDpppblhYjmqqLmn6XmmK/lkKbmnInlj6/nlKjnmoTlrZfluZVcbiAgICBjb25zdCBsaXN0QXJncyA9IFtcbiAgICAgICctLWxpc3Qtc3VicycsXG4gICAgICAnLS1za2lwLWRvd25sb2FkJyxcbiAgICAgIHVybFxuICAgIF07XG4gICAgXG4gICAgY29uc29sZS5sb2coJ0NoZWNraW5nIGF2YWlsYWJsZSBzdWJ0aXRsZXMuLi4nKTtcbiAgICBjb25zdCBsaXN0UHJvY2VzcyA9IHNwYXduKCd5dC1kbHAnLCBsaXN0QXJncywgeyBzdGRpbzogWydpZ25vcmUnLCAncGlwZScsICdwaXBlJ10gfSk7XG4gICAgXG4gICAgbGV0IGhhc1N1YnRpdGxlcyA9IGZhbHNlO1xuICAgIGxldCBvdXRwdXQgPSAnJztcbiAgICBcbiAgICBmb3IgYXdhaXQgKGNvbnN0IGRhdGEgb2YgbGlzdFByb2Nlc3Muc3Rkb3V0KSB7XG4gICAgICBjb25zdCB0ZXh0ID0gZGF0YS50b1N0cmluZygpO1xuICAgICAgb3V0cHV0ICs9IHRleHQ7XG4gICAgICAvLyDmqqLmn6XmmK/lkKbmnInlj6/nlKjnmoTlrZfluZXvvIjljIXmi6zoh6rli5XlrZfluZXlkozkurrlt6XlrZfluZXvvIlcbiAgICAgIGlmICh0ZXh0LmluY2x1ZGVzKCdBdmFpbGFibGUgc3VidGl0bGVzIGZvcicpIHx8XG4gICAgICAgICAgdGV4dC5pbmNsdWRlcygnQXZhaWxhYmxlIGF1dG9tYXRpYyBjYXB0aW9ucycpIHx8XG4gICAgICAgICAgdGV4dC5tYXRjaCgvXFx3K1xccytcXHcrXFxzK1tcXHctXSsvKSkge1xuICAgICAgICBoYXNTdWJ0aXRsZXMgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyDnrYnlvoXpgLLnqIvlrozmiJBcbiAgICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBsaXN0UHJvY2Vzcy5vbignY2xvc2UnLCAoY29kZSkgPT4ge1xuICAgICAgICBpZiAoY29kZSA9PT0gMCkgcmVzb2x2ZShjb2RlKTtcbiAgICAgICAgZWxzZSByZWplY3QobmV3IEVycm9yKGB5dC1kbHAgbGlzdC1zdWJzIGZhaWxlZCB3aXRoIGNvZGUgJHtjb2RlfWApKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIFxuICAgIGlmICghaGFzU3VidGl0bGVzKSB7XG4gICAgICBjb25zb2xlLmxvZygnTm8gc3VidGl0bGVzIGF2YWlsYWJsZSBmb3IgdGhpcyB2aWRlby4gT3V0cHV0OicsIG91dHB1dCk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHN1YnRpdGxlcyBhdmFpbGFibGUgZm9yIHRoaXMgdmlkZW8uIFRoZSB2aWRlbyBtYXkgbm90IGhhdmUgc3VidGl0bGVzIGVuYWJsZWQuJyk7XG4gICAgfVxuICAgIFxuICAgIGNvbnNvbGUubG9nKCdTdWJ0aXRsZXMgYXZhaWxhYmxlLCBwcm9jZWVkaW5nIHdpdGggZG93bmxvYWQuLi4nKTtcbiAgICBcbiAgICAvLyDkuIvovInlrZfluZXnmoTlj4PmlbjvvIzmt7vliqDpgJ/njofpmZDliLblkozph43oqabmqZ/liLZcbiAgICBjb25zdCBhcmdzID0gW1xuICAgICAgdXJsLFxuICAgICAgJy0tc2tpcC1kb3dubG9hZCcsXG4gICAgICAnLS1zdWItbGFuZycsICdlbix6aC1UVyx6aC1IYW50LHpoLGVuLVVTLGVuLVVLLGVuLUdCLGVuLUNBLGVuLUFVLGVuLU5aLGVuLUlFLGVuLVpBLGVuLUpNLGVuLUJaLGVuLVRULHpoLUhhbnMsemgtQ04semgtU0csemgtSEssemgtTU8semgtVFcnLFxuICAgICAgJy0td3JpdGUtc3ViJyxcbiAgICAgICctLXdyaXRlLWF1dG8tc3ViJyxcbiAgICAgICctLXN1Yi1mb3JtYXQnLCAndnR0JyxcbiAgICAgICctLWNvbnZlcnQtc3VicycsICd2dHQnLFxuICAgICAgJy1vJywgcGF0aC5qb2luKHdvcmtkaXIsICclKGlkKXMuJShleHQpcycpLFxuICAgICAgJy0tbm8td2FybmluZ3MnLFxuICAgICAgJy0tbm8tY2hlY2stY2VydGlmaWNhdGUnLFxuICAgICAgJy0taWdub3JlLWVycm9ycycsXG4gICAgICAnLS1uby1jYWxsLWhvbWUnLFxuICAgICAgJy0tbm8tcHJvZ3Jlc3MnLFxuICAgICAgJy0tc2xlZXAtaW50ZXJ2YWwnLCAnMScsXG4gICAgICAnLS1tYXgtc2xlZXAtaW50ZXJ2YWwnLCAnNScsXG4gICAgICAnLS1yZXRyaWVzJywgJzMnLFxuICAgICAgJy0tZXh0cmFjdG9yLXJldHJpZXMnLCAnMycsXG4gICAgICAnLS11c2VyLWFnZW50JywgJ01vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNidcbiAgICBdO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKCdSdW5uaW5nIHl0LWRscCB3aXRoIGFyZ3M6JywgYXJncy5qb2luKCcgJykpO1xuXG4gICAgY29uc29sZS5sb2coYERvd25sb2FkaW5nIHN1YnRpdGxlcyBmb3IgdmlkZW86ICR7dmlkZW9JZH1gKTtcbiAgICBhd2FpdCBydW4oJ3l0LWRscCcsIGFyZ3MpO1xuXG4gICAgLy8g5om+5Ye65omA5pyJ5Y+v6IO955qE5a2X5bmV5paH5Lu2XG4gICAgY29uc3QgZmlsZXMgPSBhd2FpdCBmcy5yZWFkZGlyKHdvcmtkaXIpO1xuICAgIGNvbnNvbGUubG9nKCdBbGwgZmlsZXMgaW4gdGVtcCBkaXJlY3Rvcnk6JywgZmlsZXMpO1xuICAgIFxuICAgIC8vIOWYl+ippuafpeaJvuS7u+S9leWtl+W5leaWh+S7tlxuICAgIGNvbnN0IHN1YnRpdGxlRXh0ZW5zaW9ucyA9IFsnLnZ0dCcsICcuc3J0JywgJy5hc3MnLCAnLnNzYScsICcudnR0Lnl0LWRscCcsICcuc3J0Lnl0LWRscCddO1xuICAgIGNvbnN0IHN1YnRpdGxlRmlsZXMgPSBmaWxlcy5maWx0ZXIoZiA9PiBcbiAgICAgIHN1YnRpdGxlRXh0ZW5zaW9ucy5zb21lKGV4dCA9PiBmLmVuZHNXaXRoKGV4dCkpXG4gICAgKTtcbiAgICBcbiAgICBpZiAoc3VidGl0bGVGaWxlcy5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ05vIHN1YnRpdGxlIGZpbGVzIGZvdW5kIGluOicsIHdvcmtkaXIpO1xuICAgICAgY29uc29sZS5sb2coJ0F2YWlsYWJsZSBmaWxlczonLCBmaWxlcyk7XG4gICAgICBcbiAgICAgIC8vIOWYl+ippueNsuWPluimlumgu+S/oeaBr+S7peaPkOS+m+abtOWlveeahOmMr+iqpOS/oeaBr1xuICAgICAgY29uc3QgaW5mb0FyZ3MgPSBbXG4gICAgICAgICctLXNraXAtZG93bmxvYWQnLFxuICAgICAgICAnLS1kdW1wLWpzb24nLFxuICAgICAgICAnLS1uby13YXJuaW5ncycsXG4gICAgICAgIHVybFxuICAgICAgXTtcbiAgICAgIFxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgaW5mb091dHB1dCA9IGF3YWl0IG5ldyBQcm9taXNlPHN0cmluZz4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGluZm9Qcm9jZXNzID0gc3Bhd24oJ3l0LWRscCcsIGluZm9BcmdzLCB7IHN0ZGlvOiBbJ2lnbm9yZScsICdwaXBlJywgJ3BpcGUnXSB9KTtcbiAgICAgICAgICBsZXQgb3V0cHV0ID0gJyc7XG4gICAgICAgICAgaW5mb1Byb2Nlc3Muc3Rkb3V0Lm9uKCdkYXRhJywgKGRhdGEpID0+IG91dHB1dCArPSBkYXRhLnRvU3RyaW5nKCkpO1xuICAgICAgICAgIGluZm9Qcm9jZXNzLnN0ZGVyci5vbignZGF0YScsIChkYXRhKSA9PiBjb25zb2xlLmVycm9yKCd5dC1kbHAgc3RkZXJyOicsIGRhdGEudG9TdHJpbmcoKSkpO1xuICAgICAgICAgIGluZm9Qcm9jZXNzLm9uKCdjbG9zZScsIChjb2RlKSA9PiB7XG4gICAgICAgICAgICBpZiAoY29kZSA9PT0gMCkgcmVzb2x2ZShvdXRwdXQpO1xuICAgICAgICAgICAgZWxzZSByZWplY3QobmV3IEVycm9yKGB5dC1kbHAgaW5mbyBmYWlsZWQgd2l0aCBjb2RlICR7Y29kZX1gKSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgdmlkZW9JbmZvID0gSlNPTi5wYXJzZShpbmZvT3V0cHV0KTtcbiAgICAgICAgY29uc29sZS5sb2coJ1ZpZGVvIGluZm86Jywge1xuICAgICAgICAgIHRpdGxlOiB2aWRlb0luZm8udGl0bGUsXG4gICAgICAgICAgZHVyYXRpb246IHZpZGVvSW5mby5kdXJhdGlvbixcbiAgICAgICAgICB1cGxvYWRlcjogdmlkZW9JbmZvLnVwbG9hZGVyLFxuICAgICAgICAgIGlzX2xpdmU6IHZpZGVvSW5mby5pc19saXZlXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8g5qqi5p+l5piv5ZCm5piv55u05pKt5oiW5Y2z5bCH55u05pKt55qE6KaW6aC7XG4gICAgICAgIGlmICh2aWRlb0luZm8uaXNfbGl2ZSB8fCB2aWRlb0luZm8ubGl2ZV9zdGF0dXMgPT09ICdpc191cGNvbWluZycpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgaXMgYSBsaXZlIG9yIHVwY29taW5nIHN0cmVhbS4gU3VidGl0bGVzIGFyZSB0eXBpY2FsbHkgbm90IGF2YWlsYWJsZSBmb3IgbGl2ZSBjb250ZW50LicpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyDmqqLmn6XoppbpoLvmmYLplbdcbiAgICAgICAgaWYgKHZpZGVvSW5mby5kdXJhdGlvbiA8IDMwKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGlzIHZpZGVvIGlzIHZlcnkgc2hvcnQuIFN1YnRpdGxlcyBtYXkgbm90IGJlIGF2YWlsYWJsZSBmb3IgdmVyeSBzaG9ydCB2aWRlb3MuJyk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIOaqouafpeimlumgu+aYr+WQpuiiq+S4i+aetuaIluengeWvhlxuICAgICAgICBpZiAodmlkZW9JbmZvLmF2YWlsYWJpbGl0eSA9PT0gJ3ByaXZhdGUnIHx8IHZpZGVvSW5mby5hdmFpbGFiaWxpdHkgPT09ICd1bmxpc3RlZCcpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgdmlkZW8gaXMgcHJpdmF0ZSBvciB1bmxpc3RlZC4gU3VidGl0bGVzIG1heSBub3QgYmUgYXZhaWxhYmxlLicpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyB2aWRlbyBpbmZvOicsIGVycm9yKTtcbiAgICAgICAgLy8g57m857qM5L2/55So6YCa55So6Yyv6Kqk5L+h5oGvXG4gICAgICB9XG4gICAgICBcbiAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gc3VidGl0bGVzIGF2YWlsYWJsZSBmb3IgdGhpcyB2aWRlby4gVGhlIHZpZGVvIG1heSBub3QgaGF2ZSBzdWJ0aXRsZXMgZW5hYmxlZCBvciB0aGV5IG1heSBiZSByZXN0cmljdGVkLmApO1xuICAgIH1cbiAgICBcbiAgICBjb25zb2xlLmxvZygnRm91bmQgc3VidGl0bGUgZmlsZXM6Jywgc3VidGl0bGVGaWxlcyk7XG4gICAgY29uc3QgdnR0cyA9IHN1YnRpdGxlRmlsZXM7ICAvLyDkvb/nlKjmib7liLDnmoTmiYDmnInlrZfluZXmlofku7ZcblxuICAgIC8vIOaMieiqnuiogOWEquWFiOe0muaOkuW6j1xuICAgIHZ0dHMuc29ydCgoYSwgYikgPT4ge1xuICAgICAgY29uc3QgbGFuZ09yZGVyID0gWyd6aC1UVycsICd6aC1IYW50JywgJ3poJywgJ2VuJywgJ2EuKiddO1xuICAgICAgY29uc3QgYUxhbmcgPSBhLnNwbGl0KCcuJylbMV0gfHwgJyc7XG4gICAgICBjb25zdCBiTGFuZyA9IGIuc3BsaXQoJy4nKVsxXSB8fCAnJztcbiAgICAgIHJldHVybiBsYW5nT3JkZXIuaW5kZXhPZihhTGFuZykgLSBsYW5nT3JkZXIuaW5kZXhPZihiTGFuZyk7XG4gICAgfSk7XG5cbiAgICAvLyDoroDlj5bnrKzkuIDlgIvlj6/nlKjnmoQgVlRUIOaWh+S7tlxuICAgIGNvbnN0IGZpbGUgPSBwYXRoLmpvaW4od29ya2RpciwgdnR0c1swXSk7XG4gICAgY29uc29sZS5sb2coYFVzaW5nIHN1YnRpdGxlIGZpbGU6ICR7ZmlsZX1gKTtcbiAgICBcbiAgICBjb25zdCB0ZXh0ID0gYXdhaXQgZnMucmVhZEZpbGUoZmlsZSwgJ3V0ZjgnKTtcbiAgICBcbiAgICAvLyDmuIXnkIYgVlRUIOWFp+WuuVxuICAgIGNvbnN0IGNsZWFuZWRUZXh0ID0gdGV4dFxuICAgICAgLnJlcGxhY2UoL15XRUJWVFQuKlxcblxcbi8sICcnKSAgLy8g56e76ZmkIFdFQlZUVCDmqJnpoK1cbiAgICAgIC5yZXBsYWNlKC9cXHJcXG4vZywgJ1xcbicpICAgICAgIC8vIOe1seS4gOaPm+ihjOesplxuICAgICAgLnJlcGxhY2UoL1xcci9nLCAnXFxuJylcbiAgICAgIC5yZXBsYWNlKC9eXFxzKy8sICcnKSAgICAgICAgICAgLy8g56e76Zmk6ZaL6aCt56m655m9XG4gICAgICAucmVwbGFjZSgvXFxzKyQvLCAnJyk7ICAgICAgICAgIC8vIOenu+mZpOe1kOWwvuepuueZvVxuXG4gICAgY29uc29sZS5sb2coJ1ZUVCBjb250ZW50IGxlbmd0aDonLCBjbGVhbmVkVGV4dC5sZW5ndGgpO1xuICAgIFxuICAgIC8vIOino+aekCBWVFQg5YWn5a65XG4gICAgY29uc3QgY3VlcyA9IHBhcnNlVlRUKGNsZWFuZWRUZXh0KTtcbiAgICBcbiAgICBpZiAoY3Vlcy5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvbnNvbGUud2FybignTm8gY3VlcyBmb3VuZCBpbiBWVFQgY29udGVudCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZyhgUGFyc2VkICR7Y3Vlcy5sZW5ndGh9IGN1ZXMgZnJvbSBWVFRgKTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGNsZWFuZWRUZXh0OyAgLy8g6L+U5Zue5Y6f5aeLIFZUVCDlhaflrrnvvIznlLEgcGFyc2VWVFQg6JmV55CGXG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gZ2V0VHJhbnNjcmlwdEJ5WXREbHA6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICAgIFxuICB9IGZpbmFsbHkge1xuICAgIC8vIOa4heeQhuaaq+WtmOebrumMhFxuICAgIHRyeSB7XG4gICAgICBhd2FpdCBmcy5ybSh3b3JrZGlyLCB7IHJlY3Vyc2l2ZTogdHJ1ZSwgZm9yY2U6IHRydWUgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIGNsZWFuIHVwIHRlbXAgZGlyZWN0b3J5OicsIGVycm9yKTtcbiAgICB9XG4gIH1cbn1cbmFzeW5jIGZ1bmN0aW9uIHJ1bihjbWQ6IHN0cmluZywgYXJnczogc3RyaW5nW10pIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlPHZvaWQ+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBjb25zdCBwID0gc3Bhd24oY21kLCBhcmdzLCB7IHN0ZGlvOiBbJ2lnbm9yZScsICdwaXBlJywgJ3BpcGUnXSB9KTtcbiAgICBcbiAgICBsZXQgc3Rkb3V0ID0gJyc7XG4gICAgbGV0IHN0ZGVyciA9ICcnO1xuICAgIFxuICAgIHAuc3Rkb3V0Py5vbignZGF0YScsIChkYXRhKSA9PiB7XG4gICAgICBjb25zdCB0ZXh0ID0gZGF0YS50b1N0cmluZygpO1xuICAgICAgc3Rkb3V0ICs9IHRleHQ7XG4gICAgICBjb25zb2xlLmxvZyh0ZXh0KTtcbiAgICB9KTtcbiAgICBcbiAgICBwLnN0ZGVycj8ub24oJ2RhdGEnLCAoZGF0YSkgPT4ge1xuICAgICAgY29uc3QgdGV4dCA9IGRhdGEudG9TdHJpbmcoKTtcbiAgICAgIHN0ZGVyciArPSB0ZXh0O1xuICAgICAgY29uc29sZS5lcnJvcih0ZXh0KTtcbiAgICB9KTtcbiAgICBcbiAgICBwLm9uKCdlcnJvcicsIHJlamVjdCk7XG4gICAgcC5vbignZXhpdCcsIChjb2RlKSA9PiB7XG4gICAgICBpZiAoY29kZSA9PT0gMCkge1xuICAgICAgICByZXNvbHZlKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZWplY3QobmV3IEVycm9yKGAke2NtZH0gZXhpdCAke2NvZGV9LiBzdGRlcnI6ICR7c3RkZXJyfWApKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59XG4iXSwibmFtZXMiOlsic3Bhd24iLCJmcyIsInBhdGgiLCJvcyIsInBhcnNlVlRUIiwiZ2V0VHJhbnNjcmlwdEJ5WXREbHAiLCJ2aWRlb0lkIiwibGFuZyIsIndvcmtkaXIiLCJta2R0ZW1wIiwiam9pbiIsInRtcGRpciIsInVybCIsImxpc3RBcmdzIiwiY29uc29sZSIsImxvZyIsImxpc3RQcm9jZXNzIiwic3RkaW8iLCJoYXNTdWJ0aXRsZXMiLCJvdXRwdXQiLCJkYXRhIiwic3Rkb3V0IiwidGV4dCIsInRvU3RyaW5nIiwiaW5jbHVkZXMiLCJtYXRjaCIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0Iiwib24iLCJjb2RlIiwiRXJyb3IiLCJhcmdzIiwicnVuIiwiZmlsZXMiLCJyZWFkZGlyIiwic3VidGl0bGVFeHRlbnNpb25zIiwic3VidGl0bGVGaWxlcyIsImZpbHRlciIsImYiLCJzb21lIiwiZXh0IiwiZW5kc1dpdGgiLCJsZW5ndGgiLCJlcnJvciIsImluZm9BcmdzIiwiaW5mb091dHB1dCIsImluZm9Qcm9jZXNzIiwic3RkZXJyIiwidmlkZW9JbmZvIiwiSlNPTiIsInBhcnNlIiwidGl0bGUiLCJkdXJhdGlvbiIsInVwbG9hZGVyIiwiaXNfbGl2ZSIsImxpdmVfc3RhdHVzIiwiYXZhaWxhYmlsaXR5IiwidnR0cyIsInNvcnQiLCJhIiwiYiIsImxhbmdPcmRlciIsImFMYW5nIiwic3BsaXQiLCJiTGFuZyIsImluZGV4T2YiLCJmaWxlIiwicmVhZEZpbGUiLCJjbGVhbmVkVGV4dCIsInJlcGxhY2UiLCJjdWVzIiwid2FybiIsInJtIiwicmVjdXJzaXZlIiwiZm9yY2UiLCJjbWQiLCJwIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/transcript.ts\n");

/***/ }),

/***/ "(rsc)/./lib/transcriptCache.ts":
/*!********************************!*\
  !*** ./lib/transcriptCache.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getOrCreateTranscript: () => (/* binding */ getOrCreateTranscript)\n/* harmony export */ });\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs/promises */ \"fs/promises\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs_promises__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _vtt__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./vtt */ \"(rsc)/./lib/vtt.ts\");\n\n\n\nconst CACHE_DIR = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), \".cache\", \"transcripts\");\n// 確保快取目錄存在\nasync function ensureCacheDir() {\n    try {\n        await fs_promises__WEBPACK_IMPORTED_MODULE_0___default().mkdir(CACHE_DIR, {\n            recursive: true\n        });\n    } catch (error) {\n        console.error(\"Failed to create cache directory:\", error);\n    }\n}\n// 生成快取檔案名稱\nfunction getCacheFilename(videoId) {\n    return path__WEBPACK_IMPORTED_MODULE_1___default().join(CACHE_DIR, `${videoId}.json`);\n}\n// 檢查快取是否存在\nasync function hasCache(videoId) {\n    try {\n        await fs_promises__WEBPACK_IMPORTED_MODULE_0___default().access(getCacheFilename(videoId));\n        return true;\n    } catch  {\n        return false;\n    }\n}\n// 讀取快取\nasync function readCache(videoId) {\n    try {\n        const cacheFile = getCacheFilename(videoId);\n        const data = await fs_promises__WEBPACK_IMPORTED_MODULE_0___default().readFile(cacheFile, \"utf-8\");\n        return JSON.parse(data);\n    } catch (error) {\n        console.error(\"Failed to read cache:\", error);\n        return null;\n    }\n}\n// 寫入快取\nasync function writeCache(videoId, data) {\n    try {\n        await ensureCacheDir();\n        const cacheFile = getCacheFilename(videoId);\n        await fs_promises__WEBPACK_IMPORTED_MODULE_0___default().writeFile(cacheFile, JSON.stringify(data, null, 2), \"utf-8\");\n    } catch (error) {\n        console.error(\"Failed to write cache:\", error);\n    }\n}\n// 清理 VTT 文本，移除重複內容和時間標記\nfunction cleanTranscriptText(text) {\n    // 移除時間標記 <00:00:00.000>\n    let cleaned = text.replace(/<\\d{1,2}:\\d{2}:\\d{2}[\\.\\,]\\d{3}>/g, \"\");\n    // 移除 <c> 標籤\n    cleaned = cleaned.replace(/<\\/?c>/g, \"\");\n    // 移除其他 HTML 標籤\n    cleaned = cleaned.replace(/<[^>]+>/g, \"\");\n    // 合併多個空白字元\n    cleaned = cleaned.replace(/\\s+/g, \" \").trim();\n    return cleaned;\n}\n// 處理 VTT 並快取結果\nasync function getOrCreateTranscript(videoId, vttContent) {\n    // 檢查是否有快取\n    if (vttContent === \"\" && await hasCache(videoId)) {\n        try {\n            return await readCache(videoId);\n        } catch (error) {\n            console.warn(\"Failed to read from cache, regenerating...\", error);\n        // 繼續生成新的快取\n        }\n    }\n    // 如果沒有提供 VTT 內容，返回空結果\n    if (!vttContent) {\n        return {\n            videoId,\n            cues: [],\n            timestamp: new Date().toISOString()\n        };\n    }\n    // 解析 VTT\n    let cues;\n    try {\n        cues = (0,_vtt__WEBPACK_IMPORTED_MODULE_2__.parseVTT)(vttContent);\n    } catch (error) {\n        console.error(\"Failed to parse VTT content:\", error);\n        throw new Error(\"Invalid VTT content\");\n    }\n    // 清理文本\n    const cleanedCues = cues.map((cue)=>({\n            ...cue,\n            text: cleanTranscriptText(cue.text)\n        })).filter((cue)=>cue.text.trim().length > 0);\n    // 移除重複的句子\n    const uniqueCues = [];\n    const seenTexts = new Set();\n    for (const cue of cleanedCues){\n        if (!seenTexts.has(cue.text) && cue.text.trim().length > 0) {\n            seenTexts.add(cue.text);\n            uniqueCues.push(cue);\n        }\n    }\n    // 合併連續的相同句子\n    const mergedCues = [];\n    let lastCue = null;\n    for (const cue of uniqueCues){\n        if (!lastCue || lastCue.text !== cue.text) {\n            lastCue = {\n                ...cue\n            };\n            mergedCues.push(lastCue);\n        } else {\n            // 合併時間範圍\n            lastCue.end = Math.max(lastCue.end, cue.end);\n        }\n    }\n    const result = {\n        videoId,\n        cues: mergedCues,\n        timestamp: new Date().toISOString()\n    };\n    // 寫入快取\n    await writeCache(videoId, result);\n    return result;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFHO0lBRTNDLFVBQVU7SUFDVixNQUFNQyxhQUFhLEVBQUU7SUFDckIsTUFBTUMsWUFBWSxJQUFJQztJQUV0QixLQUFLLE1BQU1MLE9BQU9GLFlBQWE7UUFDN0IsSUFBSSxDQUFDTSxVQUFVRSxHQUFHLENBQUNOLElBQUlkLElBQUksS0FBS2MsSUFBSWQsSUFBSSxDQUFDRyxJQUFJLEdBQUdhLE1BQU0sR0FBRyxHQUFHO1lBQzFERSxVQUFVRyxHQUFHLENBQUNQLElBQUlkLElBQUk7WUFDdEJpQixXQUFXSyxJQUFJLENBQUNSO1FBQ2xCO0lBQ0Y7SUFFQSxZQUFZO0lBQ1osTUFBTVMsYUFBYSxFQUFFO0lBQ3JCLElBQUlDLFVBQVU7SUFFZCxLQUFLLE1BQU1WLE9BQU9HLFdBQVk7UUFDNUIsSUFBSSxDQUFDTyxXQUFXQSxRQUFReEIsSUFBSSxLQUFLYyxJQUFJZCxJQUFJLEVBQUU7WUFDekN3QixVQUFVO2dCQUFFLEdBQUdWLEdBQUc7WUFBQztZQUNuQlMsV0FBV0QsSUFBSSxDQUFDRTtRQUNsQixPQUFPO1lBQ0wsU0FBUztZQUNUQSxRQUFRQyxHQUFHLEdBQUdDLEtBQUtDLEdBQUcsQ0FBQ0gsUUFBUUMsR0FBRyxFQUFFWCxJQUFJVyxHQUFHO1FBQzdDO0lBQ0Y7SUFFQSxNQUFNRyxTQUFTO1FBQ2J6QztRQUNBb0IsTUFBTWdCO1FBQ05mLFdBQVcsSUFBSUMsT0FBT0MsV0FBVztJQUNuQztJQUVBLE9BQU87SUFDUCxNQUFNZCxXQUFXVCxTQUFTeUM7SUFDMUIsT0FBT0E7QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL3l0LXNlbnRlbmNlLWxvb3AvLi9saWIvdHJhbnNjcmlwdENhY2hlLnRzPzJhYTAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGZzIGZyb20gJ2ZzL3Byb21pc2VzJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IHsgcGFyc2VWVFQgfSBmcm9tICcuL3Z0dCc7XG5cbmNvbnN0IENBQ0hFX0RJUiA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnLmNhY2hlJywgJ3RyYW5zY3JpcHRzJyk7XG5cbi8vIOeiuuS/neW/q+WPluebrumMhOWtmOWcqFxuYXN5bmMgZnVuY3Rpb24gZW5zdXJlQ2FjaGVEaXIoKSB7XG4gIHRyeSB7XG4gICAgYXdhaXQgZnMubWtkaXIoQ0FDSEVfRElSLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gY3JlYXRlIGNhY2hlIGRpcmVjdG9yeTonLCBlcnJvcik7XG4gIH1cbn1cblxuLy8g55Sf5oiQ5b+r5Y+W5qqU5qGI5ZCN56ixXG5mdW5jdGlvbiBnZXRDYWNoZUZpbGVuYW1lKHZpZGVvSWQ6IHN0cmluZyk6IHN0cmluZyB7XG4gIHJldHVybiBwYXRoLmpvaW4oQ0FDSEVfRElSLCBgJHt2aWRlb0lkfS5qc29uYCk7XG59XG5cbi8vIOaqouafpeW/q+WPluaYr+WQpuWtmOWcqFxuYXN5bmMgZnVuY3Rpb24gaGFzQ2FjaGUodmlkZW9JZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gIHRyeSB7XG4gICAgYXdhaXQgZnMuYWNjZXNzKGdldENhY2hlRmlsZW5hbWUodmlkZW9JZCkpO1xuICAgIHJldHVybiB0cnVlO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cblxuLy8g6K6A5Y+W5b+r5Y+WXG5hc3luYyBmdW5jdGlvbiByZWFkQ2FjaGUodmlkZW9JZDogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBjYWNoZUZpbGUgPSBnZXRDYWNoZUZpbGVuYW1lKHZpZGVvSWQpO1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBmcy5yZWFkRmlsZShjYWNoZUZpbGUsICd1dGYtOCcpO1xuICAgIHJldHVybiBKU09OLnBhcnNlKGRhdGEpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byByZWFkIGNhY2hlOicsIGVycm9yKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG4vLyDlr6vlhaXlv6vlj5ZcbmFzeW5jIGZ1bmN0aW9uIHdyaXRlQ2FjaGUodmlkZW9JZDogc3RyaW5nLCBkYXRhOiBhbnkpOiBQcm9taXNlPHZvaWQ+IHtcbiAgdHJ5IHtcbiAgICBhd2FpdCBlbnN1cmVDYWNoZURpcigpO1xuICAgIGNvbnN0IGNhY2hlRmlsZSA9IGdldENhY2hlRmlsZW5hbWUodmlkZW9JZCk7XG4gICAgYXdhaXQgZnMud3JpdGVGaWxlKGNhY2hlRmlsZSwgSlNPTi5zdHJpbmdpZnkoZGF0YSwgbnVsbCwgMiksICd1dGYtOCcpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byB3cml0ZSBjYWNoZTonLCBlcnJvcik7XG4gIH1cbn1cblxuLy8g5riF55CGIFZUVCDmlofmnKzvvIznp7vpmaTph43opIflhaflrrnlkozmmYLplpPmqJnoqJhcbmZ1bmN0aW9uIGNsZWFuVHJhbnNjcmlwdFRleHQodGV4dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgLy8g56e76Zmk5pmC6ZaT5qiZ6KiYIDwwMDowMDowMC4wMDA+XG4gIGxldCBjbGVhbmVkID0gdGV4dC5yZXBsYWNlKC88XFxkezEsMn06XFxkezJ9OlxcZHsyfVtcXC5cXCxdXFxkezN9Pi9nLCAnJyk7XG4gIC8vIOenu+mZpCA8Yz4g5qiZ57GkXG4gIGNsZWFuZWQgPSBjbGVhbmVkLnJlcGxhY2UoLzxcXC8/Yz4vZywgJycpO1xuICAvLyDnp7vpmaTlhbbku5YgSFRNTCDmqJnnsaRcbiAgY2xlYW5lZCA9IGNsZWFuZWQucmVwbGFjZSgvPFtePl0rPi9nLCAnJyk7XG4gIC8vIOWQiOS9teWkmuWAi+epuueZveWtl+WFg1xuICBjbGVhbmVkID0gY2xlYW5lZC5yZXBsYWNlKC9cXHMrL2csICcgJykudHJpbSgpO1xuICByZXR1cm4gY2xlYW5lZDtcbn1cblxuLy8g6JmV55CGIFZUVCDkuKblv6vlj5bntZDmnpxcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRPckNyZWF0ZVRyYW5zY3JpcHQodmlkZW9JZDogc3RyaW5nLCB2dHRDb250ZW50OiBzdHJpbmcpIHtcbiAgLy8g5qqi5p+l5piv5ZCm5pyJ5b+r5Y+WXG4gIGlmICh2dHRDb250ZW50ID09PSAnJyAmJiBhd2FpdCBoYXNDYWNoZSh2aWRlb0lkKSkge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gYXdhaXQgcmVhZENhY2hlKHZpZGVvSWQpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byByZWFkIGZyb20gY2FjaGUsIHJlZ2VuZXJhdGluZy4uLicsIGVycm9yKTtcbiAgICAgIC8vIOe5vOe6jOeUn+aIkOaWsOeahOW/q+WPllxuICAgIH1cbiAgfVxuXG4gIC8vIOWmguaenOaykuacieaPkOS+myBWVFQg5YWn5a6577yM6L+U5Zue56m657WQ5p6cXG4gIGlmICghdnR0Q29udGVudCkge1xuICAgIHJldHVybiB7XG4gICAgICB2aWRlb0lkLFxuICAgICAgY3VlczogW10sXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgIH07XG4gIH1cblxuICAvLyDop6PmnpAgVlRUXG4gIGxldCBjdWVzO1xuICB0cnkge1xuICAgIGN1ZXMgPSBwYXJzZVZUVCh2dHRDb250ZW50KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcGFyc2UgVlRUIGNvbnRlbnQ6JywgZXJyb3IpO1xuICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBWVFQgY29udGVudCcpO1xuICB9XG4gIFxuICAvLyDmuIXnkIbmlofmnKxcbiAgY29uc3QgY2xlYW5lZEN1ZXMgPSBjdWVzLm1hcChjdWUgPT4gKHtcbiAgICAuLi5jdWUsXG4gICAgdGV4dDogY2xlYW5UcmFuc2NyaXB0VGV4dChjdWUudGV4dClcbiAgfSkpLmZpbHRlcihjdWUgPT4gY3VlLnRleHQudHJpbSgpLmxlbmd0aCA+IDApO1xuXG4gIC8vIOenu+mZpOmHjeikh+eahOWPpeWtkFxuICBjb25zdCB1bmlxdWVDdWVzID0gW107XG4gIGNvbnN0IHNlZW5UZXh0cyA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuICBcbiAgZm9yIChjb25zdCBjdWUgb2YgY2xlYW5lZEN1ZXMpIHtcbiAgICBpZiAoIXNlZW5UZXh0cy5oYXMoY3VlLnRleHQpICYmIGN1ZS50ZXh0LnRyaW0oKS5sZW5ndGggPiAwKSB7XG4gICAgICBzZWVuVGV4dHMuYWRkKGN1ZS50ZXh0KTtcbiAgICAgIHVuaXF1ZUN1ZXMucHVzaChjdWUpO1xuICAgIH1cbiAgfVxuXG4gIC8vIOWQiOS9temAo+e6jOeahOebuOWQjOWPpeWtkFxuICBjb25zdCBtZXJnZWRDdWVzID0gW107XG4gIGxldCBsYXN0Q3VlID0gbnVsbDtcbiAgXG4gIGZvciAoY29uc3QgY3VlIG9mIHVuaXF1ZUN1ZXMpIHtcbiAgICBpZiAoIWxhc3RDdWUgfHwgbGFzdEN1ZS50ZXh0ICE9PSBjdWUudGV4dCkge1xuICAgICAgbGFzdEN1ZSA9IHsgLi4uY3VlIH07XG4gICAgICBtZXJnZWRDdWVzLnB1c2gobGFzdEN1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIOWQiOS9teaZgumWk+evhOWcjVxuICAgICAgbGFzdEN1ZS5lbmQgPSBNYXRoLm1heChsYXN0Q3VlLmVuZCwgY3VlLmVuZCk7XG4gICAgfVxuICB9XG5cbiAgY29uc3QgcmVzdWx0ID0ge1xuICAgIHZpZGVvSWQsXG4gICAgY3VlczogbWVyZ2VkQ3VlcyxcbiAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICB9O1xuXG4gIC8vIOWvq+WFpeW/q+WPllxuICBhd2FpdCB3cml0ZUNhY2hlKHZpZGVvSWQsIHJlc3VsdCk7XG4gIHJldHVybiByZXN1bHQ7XG59XG4iXSwibmFtZXMiOlsiZnMiLCJwYXRoIiwicGFyc2VWVFQiLCJDQUNIRV9ESVIiLCJqb2luIiwicHJvY2VzcyIsImN3ZCIsImVuc3VyZUNhY2hlRGlyIiwibWtkaXIiLCJyZWN1cnNpdmUiLCJlcnJvciIsImNvbnNvbGUiLCJnZXRDYWNoZUZpbGVuYW1lIiwidmlkZW9JZCIsImhhc0NhY2hlIiwiYWNjZXNzIiwicmVhZENhY2hlIiwiY2FjaGVGaWxlIiwiZGF0YSIsInJlYWRGaWxlIiwiSlNPTiIsInBhcnNlIiwid3JpdGVDYWNoZSIsIndyaXRlRmlsZSIsInN0cmluZ2lmeSIsImNsZWFuVHJhbnNjcmlwdFRleHQiLCJ0ZXh0IiwiY2xlYW5lZCIsInJlcGxhY2UiLCJ0cmltIiwiZ2V0T3JDcmVhdGVUcmFuc2NyaXB0IiwidnR0Q29udGVudCIsIndhcm4iLCJjdWVzIiwidGltZXN0YW1wIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwiRXJyb3IiLCJjbGVhbmVkQ3VlcyIsIm1hcCIsImN1ZSIsImZpbHRlciIsImxlbmd0aCIsInVuaXF1ZUN1ZXMiLCJzZWVuVGV4dHMiLCJTZXQiLCJoYXMiLCJhZGQiLCJwdXNoIiwibWVyZ2VkQ3VlcyIsImxhc3RDdWUiLCJlbmQiLCJNYXRoIiwibWF4IiwicmVzdWx0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/transcriptCache.ts\n");

/***/ }),

/***/ "(rsc)/./lib/vtt.ts":
/*!********************!*\
  !*** ./lib/vtt.ts ***!
  \********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   parseVTT: () => (/* binding */ parseVTT)\n/* harmony export */ });\n// 簡易 VTT 解析：轉 { start, end, text }\nfunction parseVTT(vtt) {\n    if (!vtt || typeof vtt !== \"string\") {\n        console.error(\"Invalid VTT content\");\n        return [];\n    }\n    // 正規化換行符號並分割成行\n    const lines = vtt.replace(/\\r\\n/g, \"\\n\") // 將 Windows 換行轉換為 Unix 換行\n    .replace(/\\r/g, \"\\n\") // 處理 Mac 舊版換行\n    .split(\"\\n\");\n    const cues = [];\n    let i = 0;\n    // 時間戳記匹配\n    const timeRegex = /^(\\d{1,3}:)?\\d{1,2}:\\d{2}[\\.\\,]\\d{1,3}\\s*-+>\\s*(\\d{1,3}:)?\\d{1,2}:\\d{2}[\\.\\,]\\d{1,3}/;\n    while(i < lines.length){\n        const line = lines[i].trim();\n        // 跳過空行和註解\n        if (!line || line.startsWith(\"NOTE\") || line.startsWith(\"STYLE\") || line.startsWith(\"REGION\")) {\n            i++;\n            continue;\n        }\n        // 檢查是否為時間戳記行\n        if (timeRegex.test(line)) {\n            // 分割時間戳記\n            const timeParts = line.split(/\\s*-+>\\s*/);\n            if (timeParts.length < 2) {\n                i++;\n                continue;\n            }\n            const s = timeParts[0].trim();\n            const e = timeParts[1].split(/\\s+/)[0].trim();\n            i++;\n            // 收集所有文本行\n            const textLines = [];\n            while(i < lines.length && lines[i].trim() !== \"\"){\n                textLines.push(lines[i].trim());\n                i++;\n            }\n            // 合併文本行，只做基本清理\n            let t = textLines.map((line)=>line// 移除 HTML 標籤\n                .replace(/<[^>]+>/g, \"\")// 處理基本特殊字符\n                .replace(/&amp;/g, \"&\").replace(/&lt;/g, \"<\").replace(/&gt;/g, \">\").replace(/&quot;/g, '\"').replace(/&apos;/g, \"'\").trim()).filter((line)=>line.length > 0).join(\" \").replace(/\\s+/g, \" \").trim();\n            // 計算時間（秒）\n            const start = toSec(s);\n            const end = toSec(e) || start + 2; // 如果結束時間無效，使用開始時間+2秒\n            // 添加字幕\n            if (t) {\n                cues.push({\n                    start: parseFloat(start.toFixed(3)),\n                    end: parseFloat(end.toFixed(3)),\n                    text: t\n                });\n            }\n        } else {\n            i++;\n        }\n    }\n    return cues;\n    // 1. 先按開始時間排序\n    const initialSortedCues = [\n        ...cues\n    ].sort((a, b)=>a.start - b.start || a.end - b.end);\n    // 2. 合併重疊或連續的時間段\n    const mergedTimeRanges = [];\n    for (const cue of initialSortedCues){\n        // 跳過空文本\n        const trimmedText = cue.text.trim();\n        if (!trimmedText) continue;\n        // 尋找重疊或連續的時間段\n        let mergedIndex = -1;\n        for(let i = 0; i < mergedTimeRanges.length; i++){\n            const m = mergedTimeRanges[i];\n            // 檢查是否有重疊或連續（前後1秒內）\n            if (cue.start <= m.end + 1 && cue.end >= m.start - 1) {\n                mergedIndex = i;\n                break;\n            }\n        }\n        if (mergedIndex >= 0) {\n            // 合併到現有時間段\n            const m = mergedTimeRanges[mergedIndex];\n            m.start = Math.min(m.start, cue.start);\n            m.end = Math.max(m.end, cue.end);\n            m.texts.push(trimmedText);\n        } else {\n            // 創建新的時間段\n            mergedTimeRanges.push({\n                start: cue.start,\n                end: cue.end,\n                texts: [\n                    trimmedText\n                ]\n            });\n        }\n    }\n    // 3. 對每個合併後的時間段，選擇最完整的文本\n    const processedCues = mergedTimeRanges.map((group)=>{\n        // 過濾掉重複的文本（保留最長的）\n        const uniqueTexts = Array.from(new Set(group.texts));\n        const bestText = uniqueTexts.reduce((best, current)=>current.length > best.length ? current : best);\n        // 清理文本\n        const cleanedText = bestText.replace(/\\s+/g, \" \") // 合併多個空白\n        .replace(/^\\s+|\\s+$/g, \"\") // 移除首尾空白\n        .replace(/\\.{2,}/g, \".\") // 合併多個句點\n        .replace(/\\s*[\\.,;:]\\s*/g, (match)=>match.trim() + \" \") // 標準化標點符號後的空白\n        .trim();\n        return {\n            start: group.start,\n            end: group.end,\n            text: cleanedText\n        };\n    });\n    // 4. 合併重疊的時間段，創建連續的時間軸\n    const timeline = [];\n    // 首先按開始時間排序\n    const finalSortedCues = [\n        ...processedCues\n    ].sort((a, b)=>a.start - b.start || a.end - b.end);\n    if (finalSortedCues.length > 0) {\n        // 初始化第一個時間段\n        let current = {\n            ...finalSortedCues[0]\n        };\n        for(let i = 1; i < finalSortedCues.length; i++){\n            const next = finalSortedCues[i];\n            // 如果下一個字幕與當前時間段重疊或連續\n            if (next.start <= current.end + 0.5) {\n                // 合併文本，用空格分隔\n                current.text = `${current.text} ${next.text}`.replace(/\\s+/g, \" \").trim();\n                // 擴展當前時間段的結束時間\n                current.end = Math.max(current.end, next.end);\n            } else {\n                // 保存當前時間段\n                timeline.push({\n                    ...current\n                });\n                // 開始新的時間段\n                current = {\n                    ...next\n                };\n            }\n        }\n        // 添加最後一個時間段\n        timeline.push(current);\n    }\n    // 5. 將合併後的時間段分割成不重疊的區間\n    const finalResult = [];\n    for(let i = 0; i < timeline.length; i++){\n        const current = timeline[i];\n        // 如果是第一個時間段，直接添加\n        if (i === 0) {\n            finalResult.push({\n                ...current\n            });\n            continue;\n        }\n        const prev = finalResult[finalResult.length - 1];\n        // 確保時間段不重疊\n        if (current.start < prev.end) {\n            // 調整前一個時間段的結束時間\n            prev.end = current.start;\n        }\n        // 添加當前時間段\n        finalResult.push({\n            ...current\n        });\n    }\n    // 6. 清理並合併相鄰的相同文本\n    const cleanedResult = [];\n    for (const cue of finalResult){\n        if (cleanedResult.length === 0) {\n            cleanedResult.push({\n                ...cue\n            });\n            continue;\n        }\n        const last = cleanedResult[cleanedResult.length - 1];\n        // 如果文本相同且時間連續，則合併\n        if (last.text === cue.text && last.end === cue.start) {\n            last.end = cue.end;\n        } else {\n            cleanedResult.push({\n                ...cue\n            });\n        }\n    }\n    return cleanedResult;\n}\nfunction toSec(timeStr) {\n    if (!timeStr) return 0;\n    // 處理逗號或點作為小數點分隔符\n    timeStr = timeStr.trim().replace(\",\", \".\");\n    // 匹配 hh:mm:ss.mmm 或 mm:ss.mmm 或 ss.mmm\n    const timeParts = timeStr.split(\":\");\n    let seconds = 0;\n    if (timeParts.length === 3) {\n        // 格式: hh:mm:ss.mmm\n        seconds += parseInt(timeParts[0], 10) * 3600; // 小時\n        seconds += parseInt(timeParts[1], 10) * 60; // 分鐘\n        seconds += parseFloat(timeParts[2]); // 秒 + 毫秒\n    } else if (timeParts.length === 2) {\n        // 格式: mm:ss.mmm\n        seconds += parseInt(timeParts[0], 10) * 60; // 分鐘\n        seconds += parseFloat(timeParts[1]); // 秒 + 毫秒\n    } else if (timeParts.length === 1) {\n        // 格式: ss.mmm\n        seconds = parseFloat(timeParts[0]);\n    }\n    // 確保不會返回 NaN 或負數\n    return isNaN(seconds) || seconds < 0 ? 0 : seconds;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvdnR0LnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQSxtQ0FBbUM7QUFDNUIsU0FBU0EsU0FBU0MsR0FBVztJQUNsQyxJQUFJLENBQUNBLE9BQU8sT0FBT0EsUUFBUSxVQUFVO1FBQ25DQyxRQUFRQyxLQUFLLENBQUM7UUFDZCxPQUFPLEVBQUU7SUFDWDtJQUVBLGVBQWU7SUFDZixNQUFNQyxRQUFRSCxJQUNYSSxPQUFPLENBQUMsU0FBUyxNQUFPLDBCQUEwQjtLQUNsREEsT0FBTyxDQUFDLE9BQU8sTUFBVSxjQUFjO0tBQ3ZDQyxLQUFLLENBQUM7SUFFVCxNQUFNQyxPQUF1RCxFQUFFO0lBQy9ELElBQUlDLElBQUk7SUFFUixTQUFTO0lBQ1QsTUFBTUMsWUFBWTtJQUVsQixNQUFPRCxJQUFJSixNQUFNTSxNQUFNLENBQUU7UUFDdkIsTUFBTUMsT0FBT1AsS0FBSyxDQUFDSSxFQUFFLENBQUNJLElBQUk7UUFFMUIsVUFBVTtRQUNWLElBQUksQ0FBQ0QsUUFBUUEsS0FBS0UsVUFBVSxDQUFDLFdBQVdGLEtBQUtFLFVBQVUsQ0FBQyxZQUFZRixLQUFLRSxVQUFVLENBQUMsV0FBVztZQUM3Rkw7WUFDQTtRQUNGO1FBRUEsYUFBYTtRQUNiLElBQUlDLFVBQVVLLElBQUksQ0FBQ0gsT0FBTztZQUN4QixTQUFTO1lBQ1QsTUFBTUksWUFBWUosS0FBS0wsS0FBSyxDQUFDO1lBQzdCLElBQUlTLFVBQVVMLE1BQU0sR0FBRyxHQUFHO2dCQUN4QkY7Z0JBQ0E7WUFDRjtZQUVBLE1BQU1RLElBQUlELFNBQVMsQ0FBQyxFQUFFLENBQUNILElBQUk7WUFDM0IsTUFBTUssSUFBSUYsU0FBUyxDQUFDLEVBQUUsQ0FBQ1QsS0FBSyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUNNLElBQUk7WUFFM0NKO1lBRUEsVUFBVTtZQUNWLE1BQU1VLFlBQXNCLEVBQUU7WUFDOUIsTUFBT1YsSUFBSUosTUFBTU0sTUFBTSxJQUFJTixLQUFLLENBQUNJLEVBQUUsQ0FBQ0ksSUFBSSxPQUFPLEdBQUk7Z0JBQ2pETSxVQUFVQyxJQUFJLENBQUNmLEtBQUssQ0FBQ0ksRUFBRSxDQUFDSSxJQUFJO2dCQUM1Qko7WUFDRjtZQUVBLGVBQWU7WUFDZixJQUFJWSxJQUFJRixVQUNMRyxHQUFHLENBQUNWLENBQUFBLE9BQ0hBLElBQ0UsYUFBYTtpQkFDWk4sT0FBTyxDQUFDLFlBQVksR0FDckIsV0FBVztpQkFDVkEsT0FBTyxDQUFDLFVBQVUsS0FDbEJBLE9BQU8sQ0FBQyxTQUFTLEtBQ2pCQSxPQUFPLENBQUMsU0FBUyxLQUNqQkEsT0FBTyxDQUFDLFdBQVcsS0FDbkJBLE9BQU8sQ0FBQyxXQUFXLEtBQ25CTyxJQUFJLElBRVJVLE1BQU0sQ0FBQ1gsQ0FBQUEsT0FBUUEsS0FBS0QsTUFBTSxHQUFHLEdBQzdCYSxJQUFJLENBQUMsS0FDTGxCLE9BQU8sQ0FBQyxRQUFRLEtBQ2hCTyxJQUFJO1lBRVAsVUFBVTtZQUNWLE1BQU1ZLFFBQVFDLE1BQU1UO1lBQ3BCLE1BQU1VLE1BQU1ELE1BQU1SLE1BQU1PLFFBQVEsR0FBRyxxQkFBcUI7WUFFeEQsT0FBTztZQUNQLElBQUlKLEdBQUc7Z0JBQ0xiLEtBQUtZLElBQUksQ0FBQztvQkFDUkssT0FBT0csV0FBV0gsTUFBTUksT0FBTyxDQUFDO29CQUNoQ0YsS0FBS0MsV0FBV0QsSUFBSUUsT0FBTyxDQUFDO29CQUM1QkMsTUFBTVQ7Z0JBQ1I7WUFDRjtRQUNGLE9BQU87WUFDTFo7UUFDRjtJQUNGO0lBRUEsT0FBT0Q7SUFDUCxjQUFjO0lBQ2QsTUFBTXVCLG9CQUFvQjtXQUFJdkI7S0FBSyxDQUFDd0IsSUFBSSxDQUFDLENBQUNDLEdBQUdDLElBQU1ELEVBQUVSLEtBQUssR0FBR1MsRUFBRVQsS0FBSyxJQUFJUSxFQUFFTixHQUFHLEdBQUdPLEVBQUVQLEdBQUc7SUFFckYsaUJBQWlCO0lBQ2pCLE1BQU1RLG1CQUlELEVBQUU7SUFFUCxLQUFLLE1BQU1DLE9BQU9MLGtCQUFtQjtRQUNuQyxRQUFRO1FBQ1IsTUFBTU0sY0FBY0QsSUFBSU4sSUFBSSxDQUFDakIsSUFBSTtRQUNqQyxJQUFJLENBQUN3QixhQUFhO1FBRWxCLGNBQWM7UUFDZCxJQUFJQyxjQUFjLENBQUM7UUFDbkIsSUFBSyxJQUFJN0IsSUFBSSxHQUFHQSxJQUFJMEIsaUJBQWlCeEIsTUFBTSxFQUFFRixJQUFLO1lBQ2hELE1BQU04QixJQUFJSixnQkFBZ0IsQ0FBQzFCLEVBQUU7WUFDN0Isb0JBQW9CO1lBQ3BCLElBQUkyQixJQUFJWCxLQUFLLElBQUljLEVBQUVaLEdBQUcsR0FBRyxLQUFLUyxJQUFJVCxHQUFHLElBQUlZLEVBQUVkLEtBQUssR0FBRyxHQUFHO2dCQUNwRGEsY0FBYzdCO2dCQUNkO1lBQ0Y7UUFDRjtRQUVBLElBQUk2QixlQUFlLEdBQUc7WUFDcEIsV0FBVztZQUNYLE1BQU1DLElBQUlKLGdCQUFnQixDQUFDRyxZQUFZO1lBQ3ZDQyxFQUFFZCxLQUFLLEdBQUdlLEtBQUtDLEdBQUcsQ0FBQ0YsRUFBRWQsS0FBSyxFQUFFVyxJQUFJWCxLQUFLO1lBQ3JDYyxFQUFFWixHQUFHLEdBQUdhLEtBQUtFLEdBQUcsQ0FBQ0gsRUFBRVosR0FBRyxFQUFFUyxJQUFJVCxHQUFHO1lBQy9CWSxFQUFFSSxLQUFLLENBQUN2QixJQUFJLENBQUNpQjtRQUNmLE9BQU87WUFDTCxVQUFVO1lBQ1ZGLGlCQUFpQmYsSUFBSSxDQUFDO2dCQUNwQkssT0FBT1csSUFBSVgsS0FBSztnQkFDaEJFLEtBQUtTLElBQUlULEdBQUc7Z0JBQ1pnQixPQUFPO29CQUFDTjtpQkFBWTtZQUN0QjtRQUNGO0lBQ0Y7SUFFQSx5QkFBeUI7SUFDekIsTUFBTU8sZ0JBQWdCVCxpQkFBaUJiLEdBQUcsQ0FBQ3VCLENBQUFBO1FBQ3pDLGtCQUFrQjtRQUNsQixNQUFNQyxjQUFjQyxNQUFNQyxJQUFJLENBQUMsSUFBSUMsSUFBSUosTUFBTUYsS0FBSztRQUNsRCxNQUFNTyxXQUFXSixZQUFZSyxNQUFNLENBQUMsQ0FBQ0MsTUFBTUMsVUFDekNBLFFBQVExQyxNQUFNLEdBQUd5QyxLQUFLekMsTUFBTSxHQUFHMEMsVUFBVUQ7UUFHM0MsT0FBTztRQUNQLE1BQU1FLGNBQWNKLFNBQ2pCNUMsT0FBTyxDQUFDLFFBQVEsS0FBSyxTQUFTO1NBQzlCQSxPQUFPLENBQUMsY0FBYyxJQUFJLFNBQVM7U0FDbkNBLE9BQU8sQ0FBQyxXQUFXLEtBQUssU0FBUztTQUNqQ0EsT0FBTyxDQUFDLGtCQUFrQmlELENBQUFBLFFBQVNBLE1BQU0xQyxJQUFJLEtBQUssS0FBSyxjQUFjO1NBQ3JFQSxJQUFJO1FBRVAsT0FBTztZQUNMWSxPQUFPb0IsTUFBTXBCLEtBQUs7WUFDbEJFLEtBQUtrQixNQUFNbEIsR0FBRztZQUNkRyxNQUFNd0I7UUFDUjtJQUNGO0lBRUEsdUJBQXVCO0lBQ3ZCLE1BQU1FLFdBQThELEVBQUU7SUFFdEUsWUFBWTtJQUNaLE1BQU1DLGtCQUFrQjtXQUFJYjtLQUFjLENBQUNaLElBQUksQ0FBQyxDQUFDQyxHQUFHQyxJQUFNRCxFQUFFUixLQUFLLEdBQUdTLEVBQUVULEtBQUssSUFBSVEsRUFBRU4sR0FBRyxHQUFHTyxFQUFFUCxHQUFHO0lBRTVGLElBQUk4QixnQkFBZ0I5QyxNQUFNLEdBQUcsR0FBRztRQUM5QixZQUFZO1FBQ1osSUFBSTBDLFVBQVU7WUFBRSxHQUFHSSxlQUFlLENBQUMsRUFBRTtRQUFDO1FBRXRDLElBQUssSUFBSWhELElBQUksR0FBR0EsSUFBSWdELGdCQUFnQjlDLE1BQU0sRUFBRUYsSUFBSztZQUMvQyxNQUFNaUQsT0FBT0QsZUFBZSxDQUFDaEQsRUFBRTtZQUUvQixxQkFBcUI7WUFDckIsSUFBSWlELEtBQUtqQyxLQUFLLElBQUk0QixRQUFRMUIsR0FBRyxHQUFHLEtBQUs7Z0JBQ25DLGFBQWE7Z0JBQ2IwQixRQUFRdkIsSUFBSSxHQUFHLENBQUMsRUFBRXVCLFFBQVF2QixJQUFJLENBQUMsQ0FBQyxFQUFFNEIsS0FBSzVCLElBQUksQ0FBQyxDQUFDLENBQUN4QixPQUFPLENBQUMsUUFBUSxLQUFLTyxJQUFJO2dCQUN2RSxlQUFlO2dCQUNmd0MsUUFBUTFCLEdBQUcsR0FBR2EsS0FBS0UsR0FBRyxDQUFDVyxRQUFRMUIsR0FBRyxFQUFFK0IsS0FBSy9CLEdBQUc7WUFDOUMsT0FBTztnQkFDTCxVQUFVO2dCQUNWNkIsU0FBU3BDLElBQUksQ0FBQztvQkFBRSxHQUFHaUMsT0FBTztnQkFBQztnQkFDM0IsVUFBVTtnQkFDVkEsVUFBVTtvQkFBRSxHQUFHSyxJQUFJO2dCQUFDO1lBQ3RCO1FBQ0Y7UUFDQSxZQUFZO1FBQ1pGLFNBQVNwQyxJQUFJLENBQUNpQztJQUNoQjtJQUVBLHVCQUF1QjtJQUN2QixNQUFNTSxjQUFpRSxFQUFFO0lBRXpFLElBQUssSUFBSWxELElBQUksR0FBR0EsSUFBSStDLFNBQVM3QyxNQUFNLEVBQUVGLElBQUs7UUFDeEMsTUFBTTRDLFVBQVVHLFFBQVEsQ0FBQy9DLEVBQUU7UUFFM0IsaUJBQWlCO1FBQ2pCLElBQUlBLE1BQU0sR0FBRztZQUNYa0QsWUFBWXZDLElBQUksQ0FBQztnQkFBRSxHQUFHaUMsT0FBTztZQUFDO1lBQzlCO1FBQ0Y7UUFFQSxNQUFNTyxPQUFPRCxXQUFXLENBQUNBLFlBQVloRCxNQUFNLEdBQUcsRUFBRTtRQUVoRCxXQUFXO1FBQ1gsSUFBSTBDLFFBQVE1QixLQUFLLEdBQUdtQyxLQUFLakMsR0FBRyxFQUFFO1lBQzVCLGdCQUFnQjtZQUNoQmlDLEtBQUtqQyxHQUFHLEdBQUcwQixRQUFRNUIsS0FBSztRQUMxQjtRQUVBLFVBQVU7UUFDVmtDLFlBQVl2QyxJQUFJLENBQUM7WUFBRSxHQUFHaUMsT0FBTztRQUFDO0lBQ2hDO0lBRUEsa0JBQWtCO0lBQ2xCLE1BQU1RLGdCQUFvQyxFQUFFO0lBRTVDLEtBQUssTUFBTXpCLE9BQU91QixZQUFhO1FBQzdCLElBQUlFLGNBQWNsRCxNQUFNLEtBQUssR0FBRztZQUM5QmtELGNBQWN6QyxJQUFJLENBQUM7Z0JBQUUsR0FBR2dCLEdBQUc7WUFBQztZQUM1QjtRQUNGO1FBRUEsTUFBTTBCLE9BQU9ELGFBQWEsQ0FBQ0EsY0FBY2xELE1BQU0sR0FBRyxFQUFFO1FBRXBELGtCQUFrQjtRQUNsQixJQUFJbUQsS0FBS2hDLElBQUksS0FBS00sSUFBSU4sSUFBSSxJQUFJZ0MsS0FBS25DLEdBQUcsS0FBS1MsSUFBSVgsS0FBSyxFQUFFO1lBQ3BEcUMsS0FBS25DLEdBQUcsR0FBR1MsSUFBSVQsR0FBRztRQUNwQixPQUFPO1lBQ0xrQyxjQUFjekMsSUFBSSxDQUFDO2dCQUFFLEdBQUdnQixHQUFHO1lBQUM7UUFDOUI7SUFDRjtJQUVBLE9BQU95QjtBQUNUO0FBQ0EsU0FBU25DLE1BQU1xQyxPQUFlO0lBQzVCLElBQUksQ0FBQ0EsU0FBUyxPQUFPO0lBRXJCLGlCQUFpQjtJQUNqQkEsVUFBVUEsUUFBUWxELElBQUksR0FBR1AsT0FBTyxDQUFDLEtBQUs7SUFFdEMsdUNBQXVDO0lBQ3ZDLE1BQU1VLFlBQVkrQyxRQUFReEQsS0FBSyxDQUFDO0lBRWhDLElBQUl5RCxVQUFVO0lBRWQsSUFBSWhELFVBQVVMLE1BQU0sS0FBSyxHQUFHO1FBQzFCLG1CQUFtQjtRQUNuQnFELFdBQVdDLFNBQVNqRCxTQUFTLENBQUMsRUFBRSxFQUFFLE1BQU0sTUFBTSxLQUFLO1FBQ25EZ0QsV0FBV0MsU0FBU2pELFNBQVMsQ0FBQyxFQUFFLEVBQUUsTUFBTSxJQUFNLEtBQUs7UUFDbkRnRCxXQUFXcEMsV0FBV1osU0FBUyxDQUFDLEVBQUUsR0FBWSxTQUFTO0lBQ3pELE9BQU8sSUFBSUEsVUFBVUwsTUFBTSxLQUFLLEdBQUc7UUFDakMsZ0JBQWdCO1FBQ2hCcUQsV0FBV0MsU0FBU2pELFNBQVMsQ0FBQyxFQUFFLEVBQUUsTUFBTSxJQUFNLEtBQUs7UUFDbkRnRCxXQUFXcEMsV0FBV1osU0FBUyxDQUFDLEVBQUUsR0FBWSxTQUFTO0lBQ3pELE9BQU8sSUFBSUEsVUFBVUwsTUFBTSxLQUFLLEdBQUc7UUFDakMsYUFBYTtRQUNicUQsVUFBVXBDLFdBQVdaLFNBQVMsQ0FBQyxFQUFFO0lBQ25DO0lBRUEsaUJBQWlCO0lBQ2pCLE9BQU9rRCxNQUFNRixZQUFZQSxVQUFVLElBQUksSUFBSUE7QUFDN0MiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly95dC1zZW50ZW5jZS1sb29wLy4vbGliL3Z0dC50cz9jNGY5Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIOewoeaYkyBWVFQg6Kej5p6Q77ya6L2JIHsgc3RhcnQsIGVuZCwgdGV4dCB9XG5leHBvcnQgZnVuY3Rpb24gcGFyc2VWVFQodnR0OiBzdHJpbmcpIHtcbiAgaWYgKCF2dHQgfHwgdHlwZW9mIHZ0dCAhPT0gJ3N0cmluZycpIHtcbiAgICBjb25zb2xlLmVycm9yKCdJbnZhbGlkIFZUVCBjb250ZW50Jyk7XG4gICAgcmV0dXJuIFtdO1xuICB9XG5cbiAgLy8g5q2j6KaP5YyW5o+b6KGM56ym6Jmf5Lim5YiG5Ymy5oiQ6KGMXG4gIGNvbnN0IGxpbmVzID0gdnR0XG4gICAgLnJlcGxhY2UoL1xcclxcbi9nLCAnXFxuJykgIC8vIOWwhyBXaW5kb3dzIOaPm+ihjOi9ieaPm+eCuiBVbml4IOaPm+ihjFxuICAgIC5yZXBsYWNlKC9cXHIvZywgJ1xcbicpICAgICAvLyDomZXnkIYgTWFjIOiIiueJiOaPm+ihjFxuICAgIC5zcGxpdCgnXFxuJyk7XG5cbiAgY29uc3QgY3VlczogeyBzdGFydDogbnVtYmVyOyBlbmQ6IG51bWJlcjsgdGV4dDogc3RyaW5nIH1bXSA9IFtdO1xuICBsZXQgaSA9IDA7XG4gIFxuICAvLyDmmYLplpPmiLPoqJjljLnphY1cbiAgY29uc3QgdGltZVJlZ2V4ID0gL14oXFxkezEsM306KT9cXGR7MSwyfTpcXGR7Mn1bXFwuXFwsXVxcZHsxLDN9XFxzKi0rPlxccyooXFxkezEsM306KT9cXGR7MSwyfTpcXGR7Mn1bXFwuXFwsXVxcZHsxLDN9LztcbiAgXG4gIHdoaWxlIChpIDwgbGluZXMubGVuZ3RoKSB7XG4gICAgY29uc3QgbGluZSA9IGxpbmVzW2ldLnRyaW0oKTtcbiAgICBcbiAgICAvLyDot7PpgY7nqbrooYzlkozoqLvop6NcbiAgICBpZiAoIWxpbmUgfHwgbGluZS5zdGFydHNXaXRoKCdOT1RFJykgfHwgbGluZS5zdGFydHNXaXRoKCdTVFlMRScpIHx8IGxpbmUuc3RhcnRzV2l0aCgnUkVHSU9OJykpIHtcbiAgICAgIGkrKztcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBcbiAgICAvLyDmqqLmn6XmmK/lkKbngrrmmYLplpPmiLPoqJjooYxcbiAgICBpZiAodGltZVJlZ2V4LnRlc3QobGluZSkpIHtcbiAgICAgIC8vIOWIhuWJsuaZgumWk+aIs+iomFxuICAgICAgY29uc3QgdGltZVBhcnRzID0gbGluZS5zcGxpdCgvXFxzKi0rPlxccyovKTtcbiAgICAgIGlmICh0aW1lUGFydHMubGVuZ3RoIDwgMikge1xuICAgICAgICBpKys7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCBzID0gdGltZVBhcnRzWzBdLnRyaW0oKTtcbiAgICAgIGNvbnN0IGUgPSB0aW1lUGFydHNbMV0uc3BsaXQoL1xccysvKVswXS50cmltKCk7XG4gICAgICBcbiAgICAgIGkrKztcbiAgICAgIFxuICAgICAgLy8g5pS26ZuG5omA5pyJ5paH5pys6KGMXG4gICAgICBjb25zdCB0ZXh0TGluZXM6IHN0cmluZ1tdID0gW107XG4gICAgICB3aGlsZSAoaSA8IGxpbmVzLmxlbmd0aCAmJiBsaW5lc1tpXS50cmltKCkgIT09ICcnKSB7XG4gICAgICAgIHRleHRMaW5lcy5wdXNoKGxpbmVzW2ldLnRyaW0oKSk7XG4gICAgICAgIGkrKztcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8g5ZCI5L215paH5pys6KGM77yM5Y+q5YGa5Z+65pys5riF55CGXG4gICAgICBsZXQgdCA9IHRleHRMaW5lc1xuICAgICAgICAubWFwKGxpbmUgPT4gXG4gICAgICAgICAgbGluZVxuICAgICAgICAgICAgLy8g56e76ZmkIEhUTUwg5qiZ57GkXG4gICAgICAgICAgICAucmVwbGFjZSgvPFtePl0rPi9nLCAnJylcbiAgICAgICAgICAgIC8vIOiZleeQhuWfuuacrOeJueauiuWtl+esplxuICAgICAgICAgICAgLnJlcGxhY2UoLyZhbXA7L2csICcmJylcbiAgICAgICAgICAgIC5yZXBsYWNlKC8mbHQ7L2csICc8JylcbiAgICAgICAgICAgIC5yZXBsYWNlKC8mZ3Q7L2csICc+JylcbiAgICAgICAgICAgIC5yZXBsYWNlKC8mcXVvdDsvZywgJ1wiJylcbiAgICAgICAgICAgIC5yZXBsYWNlKC8mYXBvczsvZywgXCInXCIpXG4gICAgICAgICAgICAudHJpbSgpXG4gICAgICAgIClcbiAgICAgICAgLmZpbHRlcihsaW5lID0+IGxpbmUubGVuZ3RoID4gMClcbiAgICAgICAgLmpvaW4oJyAnKVxuICAgICAgICAucmVwbGFjZSgvXFxzKy9nLCAnICcpXG4gICAgICAgIC50cmltKCk7XG4gICAgICBcbiAgICAgIC8vIOioiOeul+aZgumWk++8iOenku+8iVxuICAgICAgY29uc3Qgc3RhcnQgPSB0b1NlYyhzKTtcbiAgICAgIGNvbnN0IGVuZCA9IHRvU2VjKGUpIHx8IHN0YXJ0ICsgMjsgLy8g5aaC5p6c57WQ5p2f5pmC6ZaT54Sh5pWI77yM5L2/55So6ZaL5aeL5pmC6ZaTKzLnp5JcbiAgICAgIFxuICAgICAgLy8g5re75Yqg5a2X5bmVXG4gICAgICBpZiAodCkge1xuICAgICAgICBjdWVzLnB1c2goe1xuICAgICAgICAgIHN0YXJ0OiBwYXJzZUZsb2F0KHN0YXJ0LnRvRml4ZWQoMykpLFxuICAgICAgICAgIGVuZDogcGFyc2VGbG9hdChlbmQudG9GaXhlZCgzKSksXG4gICAgICAgICAgdGV4dDogdFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaSsrO1xuICAgIH1cbiAgfVxuICBcbiAgcmV0dXJuIGN1ZXM7XG4gIC8vIDEuIOWFiOaMiemWi+Wni+aZgumWk+aOkuW6j1xuICBjb25zdCBpbml0aWFsU29ydGVkQ3VlcyA9IFsuLi5jdWVzXS5zb3J0KChhLCBiKSA9PiBhLnN0YXJ0IC0gYi5zdGFydCB8fCBhLmVuZCAtIGIuZW5kKTtcbiAgXG4gIC8vIDIuIOWQiOS9temHjeeWiuaIlumAo+e6jOeahOaZgumWk+autVxuICBjb25zdCBtZXJnZWRUaW1lUmFuZ2VzOiBBcnJheTx7XG4gICAgc3RhcnQ6IG51bWJlcjtcbiAgICBlbmQ6IG51bWJlcjtcbiAgICB0ZXh0czogc3RyaW5nW107XG4gIH0+ID0gW107XG5cbiAgZm9yIChjb25zdCBjdWUgb2YgaW5pdGlhbFNvcnRlZEN1ZXMpIHtcbiAgICAvLyDot7PpgY7nqbrmlofmnKxcbiAgICBjb25zdCB0cmltbWVkVGV4dCA9IGN1ZS50ZXh0LnRyaW0oKTtcbiAgICBpZiAoIXRyaW1tZWRUZXh0KSBjb250aW51ZTtcbiAgICBcbiAgICAvLyDlsIvmib7ph43nlormiJbpgKPnuoznmoTmmYLplpPmrrVcbiAgICBsZXQgbWVyZ2VkSW5kZXggPSAtMTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1lcmdlZFRpbWVSYW5nZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IG0gPSBtZXJnZWRUaW1lUmFuZ2VzW2ldO1xuICAgICAgLy8g5qqi5p+l5piv5ZCm5pyJ6YeN55aK5oiW6YCj57qM77yI5YmN5b6MMeenkuWFp++8iVxuICAgICAgaWYgKGN1ZS5zdGFydCA8PSBtLmVuZCArIDEgJiYgY3VlLmVuZCA+PSBtLnN0YXJ0IC0gMSkge1xuICAgICAgICBtZXJnZWRJbmRleCA9IGk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChtZXJnZWRJbmRleCA+PSAwKSB7XG4gICAgICAvLyDlkIjkvbXliLDnj77mnInmmYLplpPmrrVcbiAgICAgIGNvbnN0IG0gPSBtZXJnZWRUaW1lUmFuZ2VzW21lcmdlZEluZGV4XTtcbiAgICAgIG0uc3RhcnQgPSBNYXRoLm1pbihtLnN0YXJ0LCBjdWUuc3RhcnQpO1xuICAgICAgbS5lbmQgPSBNYXRoLm1heChtLmVuZCwgY3VlLmVuZCk7XG4gICAgICBtLnRleHRzLnB1c2godHJpbW1lZFRleHQpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyDlibXlu7rmlrDnmoTmmYLplpPmrrVcbiAgICAgIG1lcmdlZFRpbWVSYW5nZXMucHVzaCh7XG4gICAgICAgIHN0YXJ0OiBjdWUuc3RhcnQsXG4gICAgICAgIGVuZDogY3VlLmVuZCxcbiAgICAgICAgdGV4dHM6IFt0cmltbWVkVGV4dF1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8vIDMuIOWwjeavj+WAi+WQiOS9teW+jOeahOaZgumWk+aute+8jOmBuOaTh+acgOWujOaVtOeahOaWh+acrFxuICBjb25zdCBwcm9jZXNzZWRDdWVzID0gbWVyZ2VkVGltZVJhbmdlcy5tYXAoZ3JvdXAgPT4ge1xuICAgIC8vIOmBjua/vuaOiemHjeikh+eahOaWh+acrO+8iOS/neeVmeacgOmVt+eahO+8iVxuICAgIGNvbnN0IHVuaXF1ZVRleHRzID0gQXJyYXkuZnJvbShuZXcgU2V0KGdyb3VwLnRleHRzKSk7XG4gICAgY29uc3QgYmVzdFRleHQgPSB1bmlxdWVUZXh0cy5yZWR1Y2UoKGJlc3QsIGN1cnJlbnQpID0+IFxuICAgICAgY3VycmVudC5sZW5ndGggPiBiZXN0Lmxlbmd0aCA/IGN1cnJlbnQgOiBiZXN0XG4gICAgKTtcblxuICAgIC8vIOa4heeQhuaWh+acrFxuICAgIGNvbnN0IGNsZWFuZWRUZXh0ID0gYmVzdFRleHRcbiAgICAgIC5yZXBsYWNlKC9cXHMrL2csICcgJykgLy8g5ZCI5L215aSa5YCL56m655m9XG4gICAgICAucmVwbGFjZSgvXlxccyt8XFxzKyQvZywgJycpIC8vIOenu+mZpOmmluWwvuepuueZvVxuICAgICAgLnJlcGxhY2UoL1xcLnsyLH0vZywgJy4nKSAvLyDlkIjkvbXlpJrlgIvlj6Xpu55cbiAgICAgIC5yZXBsYWNlKC9cXHMqW1xcLiw7Ol1cXHMqL2csIG1hdGNoID0+IG1hdGNoLnRyaW0oKSArICcgJykgLy8g5qiZ5rqW5YyW5qiZ6bue56ym6Jmf5b6M55qE56m655m9XG4gICAgICAudHJpbSgpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHN0YXJ0OiBncm91cC5zdGFydCxcbiAgICAgIGVuZDogZ3JvdXAuZW5kLFxuICAgICAgdGV4dDogY2xlYW5lZFRleHRcbiAgICB9O1xuICB9KTtcblxuICAvLyA0LiDlkIjkvbXph43nlornmoTmmYLplpPmrrXvvIzlibXlu7rpgKPnuoznmoTmmYLplpPou7hcbiAgY29uc3QgdGltZWxpbmU6IEFycmF5PHtzdGFydDogbnVtYmVyLCBlbmQ6IG51bWJlciwgdGV4dDogc3RyaW5nfT4gPSBbXTtcbiAgXG4gIC8vIOmmluWFiOaMiemWi+Wni+aZgumWk+aOkuW6j1xuICBjb25zdCBmaW5hbFNvcnRlZEN1ZXMgPSBbLi4ucHJvY2Vzc2VkQ3Vlc10uc29ydCgoYSwgYikgPT4gYS5zdGFydCAtIGIuc3RhcnQgfHwgYS5lbmQgLSBiLmVuZCk7XG4gIFxuICBpZiAoZmluYWxTb3J0ZWRDdWVzLmxlbmd0aCA+IDApIHtcbiAgICAvLyDliJ3lp4vljJbnrKzkuIDlgIvmmYLplpPmrrVcbiAgICBsZXQgY3VycmVudCA9IHsgLi4uZmluYWxTb3J0ZWRDdWVzWzBdIH07XG4gICAgXG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPCBmaW5hbFNvcnRlZEN1ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IG5leHQgPSBmaW5hbFNvcnRlZEN1ZXNbaV07XG4gICAgICBcbiAgICAgIC8vIOWmguaenOS4i+S4gOWAi+Wtl+W5leiIh+eVtuWJjeaZgumWk+autemHjeeWiuaIlumAo+e6jFxuICAgICAgaWYgKG5leHQuc3RhcnQgPD0gY3VycmVudC5lbmQgKyAwLjUpIHsgLy8gMC4156eS55qE57ep6KGd5Y2AXG4gICAgICAgIC8vIOWQiOS9teaWh+acrO+8jOeUqOepuuagvOWIhumalFxuICAgICAgICBjdXJyZW50LnRleHQgPSBgJHtjdXJyZW50LnRleHR9ICR7bmV4dC50ZXh0fWAucmVwbGFjZSgvXFxzKy9nLCAnICcpLnRyaW0oKTtcbiAgICAgICAgLy8g5pO05bGV55W25YmN5pmC6ZaT5q6155qE57WQ5p2f5pmC6ZaTXG4gICAgICAgIGN1cnJlbnQuZW5kID0gTWF0aC5tYXgoY3VycmVudC5lbmQsIG5leHQuZW5kKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIOS/neWtmOeVtuWJjeaZgumWk+autVxuICAgICAgICB0aW1lbGluZS5wdXNoKHsgLi4uY3VycmVudCB9KTtcbiAgICAgICAgLy8g6ZaL5aeL5paw55qE5pmC6ZaT5q61XG4gICAgICAgIGN1cnJlbnQgPSB7IC4uLm5leHQgfTtcbiAgICAgIH1cbiAgICB9XG4gICAgLy8g5re75Yqg5pyA5b6M5LiA5YCL5pmC6ZaT5q61XG4gICAgdGltZWxpbmUucHVzaChjdXJyZW50KTtcbiAgfVxuICBcbiAgLy8gNS4g5bCH5ZCI5L215b6M55qE5pmC6ZaT5q615YiG5Ymy5oiQ5LiN6YeN55aK55qE5Y2A6ZaTXG4gIGNvbnN0IGZpbmFsUmVzdWx0OiBBcnJheTx7c3RhcnQ6IG51bWJlciwgZW5kOiBudW1iZXIsIHRleHQ6IHN0cmluZ30+ID0gW107XG4gIFxuICBmb3IgKGxldCBpID0gMDsgaSA8IHRpbWVsaW5lLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgY3VycmVudCA9IHRpbWVsaW5lW2ldO1xuICAgIFxuICAgIC8vIOWmguaenOaYr+esrOS4gOWAi+aZgumWk+aute+8jOebtOaOpea3u+WKoFxuICAgIGlmIChpID09PSAwKSB7XG4gICAgICBmaW5hbFJlc3VsdC5wdXNoKHsgLi4uY3VycmVudCB9KTtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBcbiAgICBjb25zdCBwcmV2ID0gZmluYWxSZXN1bHRbZmluYWxSZXN1bHQubGVuZ3RoIC0gMV07XG4gICAgXG4gICAgLy8g56K65L+d5pmC6ZaT5q615LiN6YeN55aKXG4gICAgaWYgKGN1cnJlbnQuc3RhcnQgPCBwcmV2LmVuZCkge1xuICAgICAgLy8g6Kq/5pW05YmN5LiA5YCL5pmC6ZaT5q6155qE57WQ5p2f5pmC6ZaTXG4gICAgICBwcmV2LmVuZCA9IGN1cnJlbnQuc3RhcnQ7XG4gICAgfVxuICAgIFxuICAgIC8vIOa3u+WKoOeVtuWJjeaZgumWk+autVxuICAgIGZpbmFsUmVzdWx0LnB1c2goeyAuLi5jdXJyZW50IH0pO1xuICB9XG4gIFxuICAvLyA2LiDmuIXnkIbkuKblkIjkvbXnm7jphLDnmoTnm7jlkIzmlofmnKxcbiAgY29uc3QgY2xlYW5lZFJlc3VsdDogdHlwZW9mIGZpbmFsUmVzdWx0ID0gW107XG4gIFxuICBmb3IgKGNvbnN0IGN1ZSBvZiBmaW5hbFJlc3VsdCkge1xuICAgIGlmIChjbGVhbmVkUmVzdWx0Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgY2xlYW5lZFJlc3VsdC5wdXNoKHsgLi4uY3VlIH0pO1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IGxhc3QgPSBjbGVhbmVkUmVzdWx0W2NsZWFuZWRSZXN1bHQubGVuZ3RoIC0gMV07XG4gICAgXG4gICAgLy8g5aaC5p6c5paH5pys55u45ZCM5LiU5pmC6ZaT6YCj57qM77yM5YmH5ZCI5L21XG4gICAgaWYgKGxhc3QudGV4dCA9PT0gY3VlLnRleHQgJiYgbGFzdC5lbmQgPT09IGN1ZS5zdGFydCkge1xuICAgICAgbGFzdC5lbmQgPSBjdWUuZW5kO1xuICAgIH0gZWxzZSB7XG4gICAgICBjbGVhbmVkUmVzdWx0LnB1c2goeyAuLi5jdWUgfSk7XG4gICAgfVxuICB9XG4gIFxuICByZXR1cm4gY2xlYW5lZFJlc3VsdDtcbn1cbmZ1bmN0aW9uIHRvU2VjKHRpbWVTdHI6IHN0cmluZyk6IG51bWJlciB7XG4gIGlmICghdGltZVN0cikgcmV0dXJuIDA7XG4gIFxuICAvLyDomZXnkIbpgJfomZ/miJbpu57kvZzngrrlsI/mlbjpu57liIbpmpTnrKZcbiAgdGltZVN0ciA9IHRpbWVTdHIudHJpbSgpLnJlcGxhY2UoJywnLCAnLicpO1xuICBcbiAgLy8g5Yy56YWNIGhoOm1tOnNzLm1tbSDmiJYgbW06c3MubW1tIOaIliBzcy5tbW1cbiAgY29uc3QgdGltZVBhcnRzID0gdGltZVN0ci5zcGxpdCgnOicpO1xuICBcbiAgbGV0IHNlY29uZHMgPSAwO1xuICBcbiAgaWYgKHRpbWVQYXJ0cy5sZW5ndGggPT09IDMpIHtcbiAgICAvLyDmoLzlvI86IGhoOm1tOnNzLm1tbVxuICAgIHNlY29uZHMgKz0gcGFyc2VJbnQodGltZVBhcnRzWzBdLCAxMCkgKiAzNjAwOyAvLyDlsI/mmYJcbiAgICBzZWNvbmRzICs9IHBhcnNlSW50KHRpbWVQYXJ0c1sxXSwgMTApICogNjA7ICAgLy8g5YiG6ZCYXG4gICAgc2Vjb25kcyArPSBwYXJzZUZsb2F0KHRpbWVQYXJ0c1syXSk7ICAgICAgICAgIC8vIOenkiArIOavq+enklxuICB9IGVsc2UgaWYgKHRpbWVQYXJ0cy5sZW5ndGggPT09IDIpIHtcbiAgICAvLyDmoLzlvI86IG1tOnNzLm1tbVxuICAgIHNlY29uZHMgKz0gcGFyc2VJbnQodGltZVBhcnRzWzBdLCAxMCkgKiA2MDsgICAvLyDliIbpkJhcbiAgICBzZWNvbmRzICs9IHBhcnNlRmxvYXQodGltZVBhcnRzWzFdKTsgICAgICAgICAgLy8g56eSICsg5q+r56eSXG4gIH0gZWxzZSBpZiAodGltZVBhcnRzLmxlbmd0aCA9PT0gMSkge1xuICAgIC8vIOagvOW8jzogc3MubW1tXG4gICAgc2Vjb25kcyA9IHBhcnNlRmxvYXQodGltZVBhcnRzWzBdKTtcbiAgfVxuICBcbiAgLy8g56K65L+d5LiN5pyD6L+U5ZueIE5hTiDmiJbosqDmlbhcbiAgcmV0dXJuIGlzTmFOKHNlY29uZHMpIHx8IHNlY29uZHMgPCAwID8gMCA6IHNlY29uZHM7XG59XG4iXSwibmFtZXMiOlsicGFyc2VWVFQiLCJ2dHQiLCJjb25zb2xlIiwiZXJyb3IiLCJsaW5lcyIsInJlcGxhY2UiLCJzcGxpdCIsImN1ZXMiLCJpIiwidGltZVJlZ2V4IiwibGVuZ3RoIiwibGluZSIsInRyaW0iLCJzdGFydHNXaXRoIiwidGVzdCIsInRpbWVQYXJ0cyIsInMiLCJlIiwidGV4dExpbmVzIiwicHVzaCIsInQiLCJtYXAiLCJmaWx0ZXIiLCJqb2luIiwic3RhcnQiLCJ0b1NlYyIsImVuZCIsInBhcnNlRmxvYXQiLCJ0b0ZpeGVkIiwidGV4dCIsImluaXRpYWxTb3J0ZWRDdWVzIiwic29ydCIsImEiLCJiIiwibWVyZ2VkVGltZVJhbmdlcyIsImN1ZSIsInRyaW1tZWRUZXh0IiwibWVyZ2VkSW5kZXgiLCJtIiwiTWF0aCIsIm1pbiIsIm1heCIsInRleHRzIiwicHJvY2Vzc2VkQ3VlcyIsImdyb3VwIiwidW5pcXVlVGV4dHMiLCJBcnJheSIsImZyb20iLCJTZXQiLCJiZXN0VGV4dCIsInJlZHVjZSIsImJlc3QiLCJjdXJyZW50IiwiY2xlYW5lZFRleHQiLCJtYXRjaCIsInRpbWVsaW5lIiwiZmluYWxTb3J0ZWRDdWVzIiwibmV4dCIsImZpbmFsUmVzdWx0IiwicHJldiIsImNsZWFuZWRSZXN1bHQiLCJsYXN0IiwidGltZVN0ciIsInNlY29uZHMiLCJwYXJzZUludCIsImlzTmFOIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/vtt.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@14.2.3_react-dom@18.2.0_react@18.2.0__react@18.2.0"], () => (__webpack_exec__("(rsc)/./node_modules/.pnpm/next@14.2.3_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftranscript%2Froute&page=%2Fapi%2Ftranscript%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftranscript%2Froute.ts&appDir=C%3A%5CUsers%5CJeffrey%5CDesktop%5Ccode%5Cyt-sentence-loop%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CJeffrey%5CDesktop%5Ccode%5Cyt-sentence-loop&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();